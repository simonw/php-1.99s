<HTML>
<!--
Documentation is like sex: when it is good, it is very, very good; and
when it is bad, it is better than nothing.
                -- Dick Brandon 
-->

<HEAD>
<TITLE>PHP/FI Version 2.0</TITLE>
</HEAD>
<BODY>
<H1 ALIGN="CENTER">PHP/FI Version 2.0</H1>
<H1>Table of Contents</H1>
<OL>
	<LI><A HREF="#history">Brief History</A>
	<LI><A HREF="#install">Installation Instructions</A>
	<LI><A HREF="#starting">So, what can I do with PHP/FI?</A>
	<LI><A HREF="#redirect">CGI Redirection</A>
	<LI><A HREF="#security">Security Issues</A>
	<LI><A HREF="#module">Apache Module Notes</A>
	<LI><A HREF="#directives">Apache Module Configuration Directives</A>
	<LI><A HREF="#fastcgi">FastCGI Support</A>
	<LI><A HREF="#access">Access Control</A>
	<LI><A HREF="#logging">Access Logging</A>
	<LI><A HREF="#relative">Relative vs. Absolute URL's - or, Why do my Images Break?</A>
	<LI><A HREF="#getpost">How PHP/FI handles GET and POST method data</A>
<UL>
	<LI><A HREF="#selmul"><TT>SELECT MULTIPLE</TT> and PHP</A>
</UL>
	<LI><A HREF="#gd_support">GD (a graphics library for GIF creation) Support in PHP</A>
	<LI><A HREF="#virtual">PHP/FI and Virtual Hosts</A>
	<LI><A HREF="#upload">File Upload Support</A>
	<LI><A HREF="#msql_support">mSQL Support</A>
	<LI><A HREF="#pg95_support">Postgres95 Support</A>
	<LI><A HREF="#regexp">Regular Expressions</A>
	<LI><A HREF="#script">PHP/FI Script Language</A>
<UL>
	<LI><A HREF="#syntax">Syntax</A>
	<LI><A HREF="#vars">Variables</A>
	<LI><A HREF="#assoc">Associative Arrays</A>
	<LI><A HREF="#varvars">Variable Variables</A>
	<LI><A HREF="#lang">Language Constructs</A>
	<LI><A HREF="#user_funcs">User-Defined Functions</A>
	<LI><A HREF="#scope">Scope of Variables</A>
	<LI><A HREF="#math">Mathematical Expressions</A>
	<LI><A HREF="#while">While Loops</A>
	<LI><A HREF="#switch">Switch Construct</A>
	<LI><A HREF="#secure">Secure Variables - Defeating GET method hacks</A>
	<LI><A HREF="#overload">Overloaded Operators and dealing with variable types</A>
	<LI><A HREF="#quiet">Supressing Errors from function calls</A>
	<LI><A HREF="#funcs">Internal Functions</A>
</UL>
	<LI><A HREF="#addfunc">Adding your own functions to PHP/FI</A>
	<LI><A HREF="#hacknotes">Notes for Code Hacks</A>
</OL>

<HR>
<DL>
<A NAME="history"><H2>Brief History</H2></A>
<P>
PHP began life as a simple little cgi wrapper written in Perl.  I
wrote it in an afternoon during a period between contracts when
I needed a quick tool to get an idea of who was reading
my online resume.  It was never intended to go beyond my own
private use.  The web server where I had my resume was extremely
overloaded and had constant problems forking processes.  I rewrote
the Perl wrapper in C to get rid of the considerable overhead of
having to fork Perl each time my resume was accessed.</P>

<P>
Eventually other people on the same web server came across my
wrapper and asked if they could use it.  Then, as inevitably
happens, they started asking for more features.  I added more
features and finally put together a semi-complete distribution
along with documentation, a mailing-list and a FAQ.  The name
of this first package was Personal Home Page Tools, which
later became Personal Home Page Construction Kit.</P>

<P>
At the same time I started playing with databases and wrote a
tool to easily embed SQL queries into web pages.  It was
basically another CGI wrapper that parsed SQL queries and made
it easy to create forms and tables based on these queries.  This
tool was named FI (Form Interpreter).</P>

<P>
PHP/FI version 2.0 is a complete rewrite of these two packages
combined into a single program.  It has now evolved to
the point where it is a simple programming language embedded
inside HTML files.  The original acronym, PHP, has stuck.  It
isn't really appropriate any longer.  PHP/FI is used more for
entire web sites today than for small Personal Home Page
setups.  By whatever name, it eliminates the need for numerous small Perl
cgi programs by allowing you to place simple scripts directly in your
HTML files.  This speeds up the overall performance of your web pages
since the overhead of forking Perl several times has been eliminated.
It also makes it easier to manage large web sites by placing all
components of a web page in a single html file.  By including support
for various databases, it also makes it trivial to develop database
enabled web pages.  Many people find the embedded nature much easier
to deal with than trying to create separate HTML and CGI files.</P>

<P>
Throughout this documentation any references to PHP, FI or PHP/FI
all refer to the same thing.  The difference between PHP and FI
is only a conceptual one.  Both are built from the same source
distribution.  When I build the package without any access logging
or access restriction support, I call my binary FI.  When I build
with these options, I call it PHP.</P>

<HR>
<A NAME="install"><H2>Installation Instructions</H2></A>

<DL>
<DT><FONT SIZE=+1>Before You Begin</FONT>

<DD><P>If you have absolutely no Unix experience, you may want to ask around
for someone with a little bit of Unix knowledge to help you through
this installation.  Every attempt has been made to make it as simple
as possible, but since the software is quite involved and relies on a
number of different components, it is not realistic to assume it will
go smoothly on all systems.  You will probably need someone around who
knows the particulars of the destination system well.</P></DD>

<DT><FONT SIZE=+1>Things You Need To Know Before Installing</FONT>

<DD><P>- Can you run both get and post method cgi programs on your server?<BR>
<EM>This is not relevant if you installing the Apache module version.</EM>

  If not, you can not use this package.  On many public ISP's CGI
  programs are either disallowed or severely restricted.  If this is
  the case on your system, talk to your system administrator and ask
  him/her to have a look at this package and see if they will install
  it for you.</P></DD>

<DD><P>- If you have mSQL installed on your system, you need to know the
  base directory of this installation.</P></DD>

<DD><P>- If you have Postgres95 installed on your system, you need to
  know the base directory of this installation.</P></DD>

<DD><P>- If you are going to be storing log and access configuration files
in an NFS-mounted directory and your system does not provide NFS file locking
then you will need to define the NFS_HACK variable manually in the src/Makefile
and you may want to use a slightly modified version of the gdbm library.  See
the <STRONG>nfs_hack.txt</STRONG> file in the doc directory for more information 
on this.</P></DD>

<DD><P>- Note that if you are not interested in using PHP to track accesses to your
pages, do not compile this option into the binary.  You should also leave out
the access restriction code.  There is considerable overhead in including these
options.</P></DD>

<DD><P>- If you are installing the Apache module version, you will need to know
the Apache src code directory location.</P></DD>

<DT><FONT SIZE=+1>Installation Steps</FONT>

<DD>
<P><EM><STRONG>Step 1.</STRONG></EM>
</P>
<P>
  Run the install program: <TT>./install</TT>
</P>
<P>
  You will be asked a number of questions.  If you do not understand
  what is being asked, simply hit return.  The default choice should
  be safe on most systems.  This doesn't apply for the questions
  asking you to specify a directory for your configuration and log
  files however.  Choose any directory to which the httpd (usually &quot;nobody&quot;)
  has write privileges.  You may create this directory manually
  somewhere and simply <STRONG><TT>chown nobody directory</TT></STRONG>.</P>
<P>
<EM><STRONG>Step 2.</STRONG></EM></P>
<P>
  Go into the src directory: <TT>cd src</TT></P>
<P>
<EM><STRONG>Step 3.</STRONG></EM></P>
<P>
  type: <TT>make</TT>
</P>
<P>
  This will create the actual executable program file named <EM>php.cgi</EM>
  by default, or if you are installing the Apache module, it will create
  a <EM>libphp.a</EM> file.</P>

<P>
<EM><STRONG>Step 4. (if you are <STRONG>not</STRONG> installing the Apache module
version)</STRONG></EM></P>

<P>
  Copy the <STRONG>php.cgi</STRONG> binary to your system's cgi-bin directory.  If you
  do not have access to do this and wish to install it in your own
  personal directory, you may do so, but you should set the setuid
  bit on the executable with: <TT>chmod u+s /path/php.cgi</TT></P>
  If you do not make set the setuid bit on the binary then any files
  created by the binary will be owned by the user id under which the
  web server runs.  If this is acceptable, then you can safely leave
  the setuid bit off.</P>

<P>
<EM><STRONG>Step 4. (if you are installing the Apache module version)</STRONG></EM><BR>
  Change to your Apache src directory where the <EM>mod_php.c</EM> and <EM>mod_php.h</EM>
  files should have been copied to.  If they weren't which usually happens
  because of permission problems, copy these two files there manually.
  Edit your Apache Configuration file and add the EXTRA_LIBS line which was
  produced at the end of <STRONG>Step 3</STRONG>.  And add:</P>
<P>
<TT><STRONG>Module php_module         mod_php.o</STRONG></TT></P>
<P>
  to the very end of the file.  Then type: <STRONG>./Configure</STRONG> and then
<STRONG>make</STRONG>
  to rebuild your Apache httpd binary.  Install this binary.</P>

<P>
  Next you need to edit your Apache conf/srm.conf file and add a line like:</P>
<P>
<TT><STRONG>AddType application/x-httpd-php .phtml</STRONG></TT></P>
<P>
  This defines a new MIME, application/x-httpd-php, which will trigger the PHP
  module to parse any file ending with the <EM>.phtml</EM> extension.  You can
  pick any extension you like for this.</P>You may not want to enable everyone
  to run PHP parsed files.  You can place the above AddType line within
  &lt;Location /path&gt....&lt;/Location&gt; directives in the <EM>access.conf</EM>
  file to only allow PHP-parsed documents in certain directories on your server.</P>
<P>
 Now you are ready to restart your httpd server.  See the <A HREF="#module">Apache
 Module Notes</A> for more details on configuring the PHP Module.</P>

<DT><FONT SIZE=+1>Testing the software</FONT>

<DD>
<P>Once installed you can test to see if your executable works by
  entering a URL similar to the following in your browser:</P>
<P>
  <TT>http://your.site.domain/cgi-bin/php.cgi</TT></P>
<P>
  This should show you a page which contains the version number along
  with various other useful information. </P>
<P>
  To test the Apache module version, create any file with a .phtml
  extension and put a tag like: &lt;?phpinfo()&gt; in the file and see if
  it gets parsed.</P>

<DT><FONT SIZE=+1>Using the software</FONT>

<DD>
<P>To actually use the software on an existing HTML file, you can
  simply append the path to your file to the above URL.  ie.</P>
<P>
  <TT>http://your.site.domain/cgi-bin/php.cgi/path/file.html</TT></P>
<P>
You should have a look at the <A HREF="#redirect">CGI Redirection</A>
section of this documentation.  Running PHP/FI through a redirect
means you can automatically have a URL like <EM>http:/your.site.domain/file.phtml</EM>
be parsed by PHP/FI.</P>
<P>
This does not apply to Apace module users.</P>
</DL>

<HR>
<A NAME="starting"><H2>So, what can I do with PHP/FI?</H2></A>
<P>
The first thing you will notice if you run a page through PHP/FI is that
it adds a footer with information about the number of times your page
has been accessed (if you have compiled access logging into the binary).
This is just a very small part of what PHP/FI can
do for you.  It serves another very important role as a form interpreter
cgi, hence the FI part of the name.  For example, if you create a form
on one of your web pages, you need something to process the information
on that form.  Even if you just want to pass the information to another
web page, you will have to have a cgi program do this for you.  PHP/FI
makes it extremely easy to take form data and do things with it.</P>
<EM><STRONG>A simple example</STRONG></EM></P>
<P>
Suppose you have a form:</P>
<P>
<TT>&lt;FORM ACTION="/cgi-bin/php.cgi/~userid/display.html" METHOD=POST&gt;<BR>
&lt;INPUT TYPE="text" name="name"&gt;<BR>
&lt;INPUT TYPE="text" name="age"&gt;<BR>
&lt;INPUT TYPE="submit"&gt;<BR>
&lt;/FORM&gt;</TT></P>
<P>
Your display.html file could then contain something like:</P>
<P>
<TT>&lt;?echo "Hi $name, you are $age years old!&lt;p&gt;"&gt;</TT></P>
<P>
It's that simple!  PHP/FI automatically creates a variable for each
form input field in your form.  You can then use these variables in
the ACTION URL file.</P>
<P>
The next step once you have figured out how to use variables is to start
playing with some logical flow tags in your pages.  For example, if you wanted
to display different messages based on something the user inputs, you would
use if/else logic.  In our above example, we can display different things
based on the age the user entered by changing our display.html to:</P>
<P>
<PRE>&lt;?
    if($age>50);
        echo "Hi $name, you are ancient!&lt;p&gt;";
    elseif($age&gt;30);
        echo "Hi $name, you are very old!&lt;p&gt;";
    else;
        echo "Hi $name.";
    endif;
&gt;</PRE></P>
<P>
PHP/FI provides a very powerful scripting language which will do much more
than what the above simple example demonstrates.  See the section on the <A HREF="#script">
PHP/FI Script Language</A> for more information.</P>
<P>
You can also use PHP/FI to configure who is allowed to access your pages.
This is done using a built-in configuration screen.  With this you could
for example specify that only people from certain domains would be allowed
to see your pages, or you could create a rule which would password protect
certain pages.  See the <A HREF="#access">Access Control</A> section for more
details.</P>
<P>
PHP/FI is also capable of receiving file uploads from any RFC-1867
compliant web browser.  This feature lets people upload both text and binary
files.  With PHP/FI's access control and logical functions, you have full
control over who is allowed to upload and what is to be done with the
file once it has been uploaded.  See the <A HREF="#upload">File Upload</A>
section for more details.</P>
<P>
PHP/FI has support for a database package called mSQL.  This allows you to put
information into a database and access this information through simple embedded
SQL queries right in your .HTML files.  Adding a database backend to a web page
has never been easier.  See the section on <A HREF="#msql_support">mSQL Support</A>
for more information.</P>
<P>
PHP/FI also has support for the Postgres95 database package. It supports
embeded SQL queries in your .HTML files.  See the section on
<A HREF="#pg95_support">Postgres95 Support</A> for more information.</P>
<P>
<HR>
<A NAME="redirect"><H2>CGI Redirection</H2></A>

<DL>
<DT><STRONG>Apache</STRONG>
<DD>
<P>A good way to run PHP/FI is by using a cgi redirection module
with the Apache server.  There are two of these modules available.  One
is developed by Dave Andersen <angio@aros.net> and it is available at
<A
HREF="ftp://ftp.aros.net/pub/util/apache/mod_cgi_redirect.c">ftp://ftp.aros.net/pub/util/apache/mod_cgi_redirect.c</A>
and the other comes bundled with Apache and is called
mod_actions.c.  The modules are extremely similar.  They differ slightly in their
usage.  Both have been tested and both work with PHP/FI.</P>
<P>
One large caveat at the time of this writing (Apr.20/96) is that the current
official Apache release (1.0.5) has a severe limitation which prevents
cgi redirected requests from having any post-method data associated with
them.  I have tracked this down and fixed it in my version of Apache, and there
is an official patch available in the <A HREF="http://www.vex.net/php/files">
File Archives</A> on the <A HREF="http://www.vex.net/php">PHP Home Page</A>.</P>
Check the Apache documentation on how to add a module.  Generally you
add the module name to a file called <EM>Configuration</EM>.
The line to be added if you want to use the mod_actions module is:</P>
<P>
<TT>Module action_module       mod_actions.o</TT></P>
<P>
If you are using the mod_cgi_redirect.c module add this line:</P>
<P>
<TT>Module cgi_redirect_module mod_cgi_redirect.o</TT></P>
<P>
Then compile your httpd and install it.  To configure the cgi redirection
you need to either create a new mime type in your <EM>mime.types</EM> file
or you can use the <STRONG>AddType</STRONG> command in your <EM>srm.conf</EM>
file to add the mime type.  The mime type to be added should be something
like this:</P>
<P>
<TT>application/x-httpd-php     phtml</TT></P>
<P>
If you are using the mod_actions.c module you need to add the following
line to your <EM>srm.conf</EM> file:</P>
<P>
<TT>Action application/x-httpd-php /cgi-bin/php.cgi</TT></P>
<P>
If you are using mod_cgi_redirect.c you should add this line to
<EM>srm.conf</EM>:</P>
<P>
<TT>CgiRedirect     application/x-httpd-php     /cgi-bin/php.cgi</TT></P>
<P>
Don't try to use both mod_actions.c and mod_cgi_redirect.c at the same
time.</P>
<P>
Once you have one of these cgi redirection modules installed and
configured correctly, you will be able to specify that you want a
file parsed by php/fi simply by making the file's extension
<STRONG>.phtml</STRONG>.  Furthermore, if you add <STRONG>index.phtml</STRONG>
to your <STRONG>DirectoryIndex</STRONG> configuration line in your
<EM>srm.conf</EM> file then the top-level page in a directory will be
automatically parsed by php if your index file is called index.phtml.</P>

<DT><STRONG>Netscape HTTPD</STRONG>
<DD>
<P>
You can automatically redirect requests for files with a given
extension to be handled by PHP/FI by using the Netscape Server
CGI Redirection module.  This module is available in the
<A HREF="http://www.vex.net/php/files">File Archives</A> on the
<A HREF="http://www.vex.net/php">PHP/FI Home Page</A>.  The README
in the package explicitly explains how to configure it for use with
PHP/FI.</P>

<DT><STRONG>NCSA HTTPD</STRONG>
<DD>
<P>
NCSA does not currently support modules, so in order to do cgi
redirection with this server you need to modify your server source
code.  A patch to do this with NCSA 1.5 is available in the
<A HREF="http://www.vex.net/php/files">PHP/FI file archives</A>.
</DL>
<HR></P>
<A NAME="security"><H2>Security Issues</H2></A>
<DD>
<P>
PHP/FI does <STRONG>not</STRONG> read any <EM>.htaccess</EM> files which
may be present in a directory.  This means that if you have files that
are protected using the standard .htaccess server-based access control
feature, people could potentially circumvent this security by loading the
page through PHP/FI.</P>
<P>
There are a couple of different solutions to this problem.  The easiest
is probably to use the <STRONG>PATTERN_RESTRICT</STRONG> feature found
in <EM>php.h</EM>.  This lets you define an extension (or a pattern of
extensions) which are allowed to be parsed by PHP/FI.  If a file does
not have this extension and someone tries to load it with PHP/FI, an
<EM>access denied</EM> message will appear.</P>
<P>
Another solution is to use the PHP/FI access control mechanism to mimic the
access control setup you have in your .htaccess file.  Keeping this information
in two places can be tedious though, and the two systems don't share all
of the same features.</P>
<P>
The problem can also be solved using file permissions.  PHP/FI can be set
up to run setuid as any user you wish.  Then files that are to be read
by PHP/FI can be given appropriate permissions and files not to be read
by PHP/FI should be owned by another user id and have their permissions
changed accordingly.</P>

<HR>
<A NAME="module"><H2>Apache Module Notes</H2></A>
<P>
Running PHP/FI as an Apache module is the most efficient way of using the
package.  Running it as a module means that the PHP/FI functionality is
combined with the Apache server's functionality in a single program.  There
are a number of advantages to running it as a module:</P>
<DL>
<DT><STRONG>Performance</STRONG>
<DD>
<P>Performance-wise it is a lot faster than traditional CGI programs.  In fact,
when running PHP/FI as a module, there is no CGI involved.  The script code
in the HTML files is executed directly by the Apache web server process.</P>

<DT><STRONG>Security</STRONG>
<DD>
<P>When running as a module, the normal httpd-based access restriction rules
defined either in the Apache conf files or in private .htaccess files are first
applied before the module is allowed to parse the file.</P>

<DT><STRONG>Configurability</STRONG>
<DD>
<P>Since the parser is always active inside the httpd process, it can be configured
on startup using the same configuration files used to configure the httpd process.
The module can even be configured on a per-directory basis by placing the
<A HREF="#directives">PHP configuration directives</A> in the <EM>.htaccess</EM> files.</P>
</DL>

<A NAME="directives"><H2>Apache Module Configuration Directives</H2></A>
<P>
The following directives can be placed either in the <EM>srm.conf</EM> file, or
within &lt;Directory&gt;...&lt;/Directory&gt; tags in <EM>access.conf</EM> or in
&lt;Location /path&gt;...&lt//Location&gt; tags in <EM>access.conf</EM> or in
individual <EM>.htaccess</EM> files:</P>
<DL>
<DT><STRONG>phpShowInfo <EM>on</EM>|<EM>off</EM></STRONG>
<DD>Turn the PHP info footers on or off.</P>
<DT><STRONG>phpLogging <EM>on</EM>|<EM>off</EM></STRONG>
<DD>Turn logging on or off.</P>
<DT><STRONG>phpUploadTmpDir <EM>directory</EM></STRONG>
<DD>Set the directory where form-uploaded files will be placed.</P>
<DT><STRONG>phpDbmLogDir <EM>directory</EM></STRONG>
<DD>Set the directory where dbm-based logging files will be written.</P>
<DT><STRONG>phpMsqlLogDB <EM>database</EM></STRONG>
<DD>Set name of mSQL database to use for logging.</P>
<DT><STRONG>phpAccessDir <EM>directory</EM></STRONG>
<DD>Set the directory where PHP-internal access control files are stored.</P>
<DT><STRONG>phpMaxDataSpace <EM>KiloBytes</EM></STRONG>
<DD>Max size a sub-pool can grow to within the PHP module.  Setting this value
to a low number will minimize the impact that mod_php will have on your system,
but it may also limit people from writing complex scripts.</P>
</DL>
All of these directives are optional.  If a directive is not specified anywhere,
the compile-time default will be used.</P>

<HR>
<A NAME="fastcgi"><H2>FastCGI Support</H2></A>
<P>
PHP/FI can be compiled with FastCGI support.  
You will need fetch and compile
<A HREF="http://www.fastcgi.com">FCGI Development Kit</A> for your platform before
compiling PHP/FI.  You will also need to get <A HREF="#redirect">CGI Redirection</A> working.
Then follow the instructions in the FastCGI documentation for configuring FastCGI 
for your platform.  If you are using the mod_fastcgi module with the Apache server, here
are the step-by-step instructions:</P>
<P><UL>
<LI>Edit your Apache Configuration file and add the mod_fastcgi module, then recompile Apache.
<LI>Edit your <EM>srm.conf</EM> file and add lines similar to:<br>
<TT>
AddType application/x-httpd-fcgi .fcgi<br>
AppClass /usr/local/etc/httpd/fcgi-bin/php.fcgi -processes 4<br>
AddType application/x-httpd-fphp .fhtml<br>
Action application/x-httpd-fphp /fcgi-bin/php.fcgi<br>
</TT>
<LI>Copy your <EM>php.cgi</EM> binary to <EM>/usr/local/etc/httpd/fcgi-bin/php.fcgi</EM>
</UL></P>
<P>
Now, any pages with the .fhtml extension will be handed off to the FastCGI php.fcgi 
process which is already running.  The php.fcgi binary will still work as a normal
CGI binary, so you could just create a symbolic link from php.cgi to php.fcgi.</P>
<P>If you are not using Apache, the above steps will be similar, but not identical.
CGI Redirection mechanisms are available for NCSA and Netscape servers at the
<A HREF="http://www.vex.net/php/files">PHP/FI File Archive</A>.</P>
<HR>
<A NAME="access"><H2>Access Control</H2></A>
<P>
If you chose to include access control when you compiled the package, you
may append <EM>?config</EM> to any URL to edit the access control file.  ie.</P>
<P>
<TT>http://your.machine.domain/cgi-bin/php.cgi/path/file.html?config</TT></P>
<P>
Your configuration password will initially be set to your user id.  If your user
id does not work as your password, it probably means that PHP could not read
the /etc/passwd file to locate your user id.  If this is the case, the initial
password will be set to "<STRONG>php</STRONG>". It is a good idea to change this password.
Note that multiple users may maintain their own personal configuration files
through a single PHP/FI binary.</P>
<P>
Access Control can be quite confusing initially.  The ?config screen is divided up
into a number of sections.  The top section is for changing the password used to
make sure that only people who know this password can change access control
characteristics.  In a system-wide installation, each user has his or her own
configuration screen with his or her own password.</P>
<P>
The second section of the ?config screen consists of a number of tables.  Each
table defines a rule-set.  The first rule-set is always the default rule-set.
This default rule-set is used if a page does not have a rule-set defined specifically
for it.  After the default rule-set, any number of specific rule-set tables will
follow.</P>
<P>
To add a rule-set for a specific file, enter the URL of the file in your browser and
add <EM><STRONG>?config</STRONG></EM> to the end of the URL.  On the ?config screen that comes
up you will see that a rule-set has been added for this page, if it wasn't already
there.  When a new rule-set is added, it is initially set to be the same as the
default rule-set.  The following picture shows two simple rule-sets.  First a
default rule-set which just indicates that hits from all domains should be
logged, and second, for the file /~rasmus/test.html and only that file, any
users coming from a &quot;<EM>.edu</EM>&quot; domain will not be granted access.</P>
<P>
<IMG SRC="config.gif" alt="[Image of ?config screen]"></P>
<P>
To edit a rule-set modify the fields until the desired configuration is
reached within a rule-set and then hit the &quot;<EM>Submit Changes</EM>&quot;
button.  If more rules are needed, hit the &quot;<EM>Add Rule</EM>&quot;
button and then edit the added rule.</P>
<P>
To delete a rule, select the checkbox to the right of the rule and
hit the &quot;<EM>Submit Changes</EM>&quot; button.  The screen will
redraw and the rule should disppear.</P>
<P>
Note that you need to enter a regular expression in the pattern field.
See the section on regular expressions in this documentation for more
details.</P>

<HR>
<A NAME="logging"><H2>Access Logging</H2></A>
<P>
Access Logging is another optional feature which can be enabled at compile-time
by answering <EM>Yes</EM> to the question in the install script.  You may either
store your access log data in dbm files or in an mSQL database.  The latter
is more powerful, but is also a bit more difficult to set up.</P>
<P>
To use dbm files for storing your access logs, you will need to specify a directory
in which log files can be written.  PHP will try to create this directory if it doesn't
exist, but to make sure it has the proper permissions, you may want to create
this directory yourself before running PHP for the first time.  The permissions
on the directory should be such that the user id under which the PHP cgi program
will run can write to the directory.</P>
<P>
To use an mSQL database for storing your access log data, you need to first
make sure you have mSQL installed and running on your system.  Then you need
to create a database.  The default name is &quot;phpfi&quot; although this
can be changed in <EM>src/php.h</EM>.  To create this database, type:</P>
<P>
<PRE>    msqladmin create phpfi</PRE></P>
<P>
Then edit your <EM>msql.acl</EM> file and make sure the permissions on the database
are correct.  Something like the following should suffice:</P>
<P>
<PRE>    database=phpfi
    read=*
    write=nobody,&lt;your user id&gt;
    access=local</PRE></P>
<P>
For each user id for whom you want to store log data, you need to create two
tables.  The <EM>msqllog</EM> shell script in the scripts directory will do
this for you.  Simply type:</P>
<P>
<PRE>    msqllog <user id></PRE></P>
<P>
and the script will create the appropriate tables.  You may need to edit the
script to make it reflect where things are stored on your system.</P>
<P>
You may want to have a look at this script.  It defines the field sizes of your
log tables.  If, for example, you know that your file paths exceed 64 characters,
you need to bump up the filename size in both the <EM>logN</EM> and the <EM>lastN</EM>
tables in this <EM>msqllog</EM> file.</P>
<P>
Access logging stores information about each &quot;hit&quot; on a page.  This
information can then be summarized by examining these log files.  An example
log file summarizing script is included in the package.  It is the <TT>log.html</TT>
file in the <TT>examples</TT> directory.  This is the dbm log file analyzer.  The
msql log file analyzer is called <TT>mlog.html</TT>.  To run it, copy it to a
directory accessible from your web server and type:</P>
<P>
<TT>http://your.machine.domain/cgi-bin/php.cgi/path/log.html</TT></P>
<P>
By default, if you have compiled PHP with access logging enabled, then your
pages will appear with a footer containing some access information.
You may not want to see this footer, but still log hits.  You may turn these
log footers off either by creating a rule in the <A HREF="#access">?config</A>
section for the page, or by adding a tag like this to your
page:</P><P><TT>&lt;?setshowinfo(0)&gt;</TT></P>
<HR><A NAME="relative"><H2>Relative vs. Absolute URL's - or, Why do my Images Break?</H2></A>
<P>A problem common to all CGI wrappers is that the HTTPD program changes the current
directory to the directory where whatever it is loading is stored.  In the case
of a CGI program, the current directory is set to the directory where the CGI
program resides.  This is normally not a problem, except when it comes to relative
URL's.</P>
<P>
A relative URL is a URL which relies upon the current directory being the same
as the directory where the current HTML file is located.  So, for example, if
I had the URL:</P>
<P>
<PRE>    http://my.machine/~rasmus/file.html</PRE></P>
<P>
the actual HTML file might be:</P>
<P>
<PRE>    ~rasmus/public_html/file.html</PRE></P>
<P>
If within the <TT>file.html</TT> file I had the tag:</P>
<P>
<PRE>    &lt;IMG SRC=&quot;pic.gif&quot;&gt;</PRE></P>
<P>
when loaded normally this file gif file is expected to be in
<TT>~rasmus/public_html/pic.gif</TT>.  However, when loaded through a CGI
wrapper with a URL like:</P>
<P>
<PRE>    http://my.machine/cgi-bin/php.cgi/~rasmus/file.html</PRE></P>
<P>
then HTTPD sets the current directory to <TT>/cgi-bin</TT>
(or wherever the ScriptAlias might point)
and subsequently when the page is loaded the <TT>pic.gif</TT> file is expected to be
in: <TT>/cgi-bin/pic.gif</TT> which is usually not the desired effect.</P>
<P>
The quick way around this problem is to use absolute URL's.  In the above example
if the image tag had been:</P>
<PRE>    &lt;IMG SRC=&quot;/~rasmus/pic.gif&quot;&gt;</PRE>
<P>
then there would have been no problem.  Using absolute URL's is not always
desirable as it makes pages less portable.  An obvious question you may have at
this point is, &quot;Why doesn't PHP just change the current directory to the right
place?&quot;.  The answer is that PHP actually does change the current directory
to the location of the HTML file it is displaying.  Any file paths used inside
PHP Script tags, can be relative.  The problem is that tags outside of PHP's
control such as &lt;img &gt; and &lt;a href &gt; will not be passed through
PHP.  When they are parsed, PHP is no longer active and the current working
directory has been set back to the directory specified by the HTTP Daemon.</P>
<P>
<STRONG>The Solution</STRONG> is a compromise.  PHP provides a variable called
<STRONG>PATH_DIR</STRONG>.
It contains the directory portion of the current HTML file at all times.  If this
PATH_DIR variable is used in the &lt;img &gt; and &lt;a href &gt; tags then the
effect of a relative URL can be achieved, although to the server it will look like
an absolute URL when parsed.  From our above example, the only change we
would need to make would be to change the img tag to:
<PRE>    &lt;IMG SRC=&quot;&lt;?echo $PATH_DIR&gt;/pic.gif&quot;&gt;</PRE>
By using the above, you can move the file containing this tag around, and the
tag will always refer to a <TT>pic.gif</TT> file in the same directory as
the source HTML file.</P>
<P>
Another way to handle this is to use the traditional &lt;BASE HREF=...&gt; in
the HTML file.</P>
<HR>
<A NAME="getpost"><H2>How PHP handles GET and POST method data</H2></A>
<P>
PHP will detect both GET and POST method data coming from HTML forms.
One important point to understand is that POST method data is always
treated first if both are present.  If a PHP variable is defined by the POST
method data, or if the variable is defined by the HTTP daemon in the Unix
environment, then GET method data cannot overwrite it.  This is to prevent
somebody from adding <EM>?REMOTE_HOST=some.bogus.host</EM> to their URL's
and thus tricking the PHP logging mechanism into recording this alternate
data.  POST method data is however allowed to overwrite these variables.</P>
<P>
Any component of the GET data (the data following a '?' in the URL) which is
of the form, <EM>word=something</EM> will define the variable <EM>$word</EM> to
contain the value <EM>something</EM>.  Even if the data is not of this form,
it can be accessed with the $argv built-in array.  For example, in a URL like:</P>
<PRE>    /cgi-bin/php.cgi/file.html?abc+def+EMAIL_ADDR=rasmus@vex.net&var==value</PRE>
The relevant components of the PHP symbol table will be:</P>
<PRE>    $argc       = 4
    $argv[0]    = abc
    $argv[1]    = def
    $argv[2]    = EMAIL_ADDR=rasmus@vex.net&var==value
    $EMAIL_ADDR = rasmus@vex.net
    $var        = value</PRE>
<P>
Notice how the EMAIL_ADDR part of the data shows up both as $argv[2] where it is
unparsed, and the $EMAIL_ADDR variable is created to contain <EM>rasmus@vex.net</EM>.</P>
<P>
The $EMAIL_ADDR variable was used as an example in the above because it
is a useful variable if you are using the logging features of PHP.  By adding:</P>
<PRE>    ?EMAIL_ADDR=</PRE>
<P>
to any links on a page where the user's email address is known, you may propagate
it to the next page.  The PHP logging system will automatically look for this
variable and record its value as the user's e-mail address in the logs.  For
any users of PHP1, the above serves the same function as adding
<EM>?&lt;!--$email--&gt;</EM> to the URL used to do in PHP1.  It looks a little
bit more complex now, but it is also completely general allowing you to
build your own complex pages.</P>
<P>
In the above example you can also see how multiple variables can be defined
right in the GET method data by separating each with the &quot;&amp;&quot; character.  This
&quot;&amp;&quot; separated list of variables must be the last (or only) component of the
GET method data for it to be valid.</P>
<P>
<A NAME="selmul"><STRONG><TT>SELECT MULTIPLE</TT> and PHP</STRONG></A></P>
<P>
The SELECT MULTIPLE tag in an HTML construct allows users to select
multiple items from a list.  These items are then passed to the action
handler for the form.  The problem is that they are all passed with the
same widget name. ie.</P>
<PRE>    &lt;SELECT NAME=&quot;var&quot; MULTIPLE&gt;</PRE>
<P>
Each selected option will arrive at the action handler as:</P>
<P>
var=option1<BR>
var=option2<BR>
var=option3</P>
<P>
Each option will overwrite the contents of the previous $var variable.
The solution is to use PHP/FI's non-indexed array feature.  The following
should be used:</P>
<P>
<PRE>    &lt;SELECT NAME=&quot;var[]&quot; MULTIPLE&gt;</PRE></P>
<P>
This tells PHP/FI to treat <EM>var</EM> as an array an each assignment of
a value to var[] adds an item to the array.  The first item becomes $var[0],
the next $var[1], etc.  The <A HREF="#count">count()</A> function can be
used to determine how many options were selected, and the <A HREF="#sort">
sort()</A> function can be used to sort the option array if necessary.</P>
<HR>
<P>
<A NAME="gd_support"><H2>GD (a graphics library for GIF creation) Support in PHP</H2></A>
PHP supports the GD library version 1.2 written by Thomas Boutell.  There is no GD
code in PHP itself.  If you wish to use the GD support in PHP/FI, you must obtain the
GD library from <A HREF="http://www.boutell.com/gd/gd1.2.tar.Z">
http://www.boutell.com/gd/gd1.2.tar.Z</A>, install it, and then re-install PHP.</P>
Not all of the GD features are supported by PHP.  For a list of supported functions see
the <A HREF="#funcs">Alphabetical List of Functions</A>.  All the GD functions
start with the word, <EM>Image</EM>.</P>  More information on the GD package is available at:
<A HREF="http://www.boutell.com/gd/">http://www.boutell.com/gd/</A>.</P>
<P>
<EM>GD 1.2 is copyright 1994, 1995 Quest Protein Database Center, Cold Springs Harbor Labs.</EM></P>
<HR>
<P>
<A NAME="virtual"><H2>PHP/FI and Virtual Hosts</H2></A>
PHP works fine on virtual host setups supported by some http daemons.  The one
problem that may occur on such a setup is related to an inconsistency in the
way httpd sets the SCRIPT_NAME environment variable.  Normally it is set to the
path of the current CGI program in relation to the top-level ROOT_DIR on the
httpd server.  However, when a virtual domain is used, some httpd's do not
correctly set the SCRIPT_NAME variable as the relative path from the virtual
domain's top level directory as it should.  If the ?config screen gives you
an invalid URL error message, you know that this problem exists on your setup.
You will need to edit the <EM>php.h</EM> file and set the VIRTUAL_PATH #define to
the path to your <EM>php.cgi</EM> binary relative to your top-level directory.</P>
<HR>
<A NAME="upload"><H2>File Upload Support</H2></A>
<P>
PHP/FI will automatically detect a file upload from a browser which supports the
form-based file upload features as proposed by
<A HREF="mailto:nebel@xsoft.sd.xerox.com">E. Nebel</A>
and <A HREF="mailto:masinter@parc.xerox.com">L. Masinter</A> from Xerox and described in
<A HREF="ftp://ds.internic.net/rfc/rfc1867.txt">RFC 1867</A>.</P>
A file upload screen can be built by creating a special form which looks
something like this:</P>
<P>
<BLOCKQUOTE>

    &lt;FORM ENCTYPE="multipart/form-data" ACTION="_URL_" METHOD=POST&gt;

<BR>&lt;INPUT TYPE="hidden" name="MAX_FILE_SIZE" value="1000"&gt;

<BR>Send this file: &lt;INPUT NAME="userfile" TYPE="file"&gt;

<BR>&lt;INPUT TYPE="submit" VALUE="Send File"&gt;

<BR>&lt;/FORM&gt;

</BLOCKQUOTE>
</P>
<P>
The _URL_ should point to a php html file.  The MAX_FILE_SIZE hidden
field must precede the file input field and its value is the maximum filesize
accepted.  The value is in bytes.  In this destination file, the following
variables will be defined upon a successful upload:</P>

<DL>
<DT><STRONG>$userfile</STRONG>
<DD>
<P>The temporary filename in which the uploaded file was stored on the server machine.</P>
<DT><STRONG>$userfile_name</STRONG>
<DD>
<P>The original name of the file on the sender's system.</P>
<DT><STRONG>$userfile_size</STRONG>
<DD>
<P>The size of the uploaded file in bytes.</P>
<DT><STRONG>$userfile_type</STRONG>
<DD>
<P>The mime type of the file if the browser provided this information.  An example would
be "image/gif".</P>
</DL>
<P>The <EM><STRONG>$userfile</STRONG></EM> basename of the above variables will match the
NAME field in the upload form.</P>
<P>
Files will by default be stored in the server's default temporary directory.  This
can be changed by setting the environment variable TMPDIR in the environment in which
PHP/FI runs.  Setting it using a PutEnv() call from within a PHP/FI script will not
work though.  Alternatively, you may hardcode in a temporary directory by editing
<EM>php.h</EM> and defining the <STRONG>UPLOAD_TMPDIR</STRONG> variable.</P>
<P>
The PHP/FI script which receives the uploaded file should implement whatever
logic is necessary for determining what should be done with the uploaded file.
You can for example use the $file_size variable to throw away any files that are
either too small or too big.  You could use the $file_type variable to throw away
any files that didn't match a certain type criteria.  Whatever the logic, you should
either delete the file from the temporary directory or move it elsewhere.</P>
<P>
Please note that the CERN httpd seems to strip off everything starting at
the first whitespace in the content-type mime header it gets from the
client.  As long as this is the case, CERN httpd will not support the
file upload feature.</P>
</DL>

<HR>
<A NAME="msql_support"><H2>mSQL Support</H2></A>
<P>mSQL stands for mini-SQL and is a small and simple SQL database engine written
by David Hughes.  It is available from <A HREF="ftp://ftp.bond.edu.au/pub/Minerva/msql">
ftp://ftp.bond.edu.au/pub/Minerva/msql</A></P>
<P>
PHP/FI supports has a rich set of mSQL support functions:
</P>
<DL>
<DT><A HREF="#msql">msql()</A>
<DT><A HREF="#msql_connect">msql_Connect()</A>
<DT><A HREF="#msql_fieldflags">msql_FieldFlags()</A>
<DT><A HREF="#msql_fieldlen">msql_FieldLen()</A>
<DT><A HREF="#msql_fieldname">msql_FieldName()</A>
<DT><A HREF="#msql_fieldtype">msql_FieldType()</A>
<DT><A HREF="#msql_freeresult">msql_FreeResult()</A>
<DT><A HREF="#msql_numfields">msql_NumFields()</A>
<DT><A HREF="#msql_numrows">msql_NumRows()</A>
<DT><A HREF="#msql_regcase">msql_NumRows()</A>
<DT><A HREF="#msql_result">msql_Result()</A>
</DL>
<P>
In addition to these functions, PHP/FI can also be compiled to automatically
escape any forward single quote ( ' ) characters found in GET or POST data.
If the MAGIC_QUOTES variable is defined in the <EM>php.h</EM> file then
these quotes will be automatically escaped making it easier to pass
form data directly to msql queries.</P>
<HR>
<A NAME="pg95_support"><H2>Postgres95 Support</H2>
<P>
Postgres95 is a powerfull public domain database that implements a significant
subset of the SQL language.  It supports many datatypes and commands that
are not available in mSQL.  More information about Postgres95 and the software
itself can be found at this URL:
<A HREF="http://epoch.cs.berkeley.edu:8000/postgres95/">
http://epoch.cs.berkeley.edu:8000/postgres95/</A>.</P>
<P>
The following PHP functions are available for Postgres95:</P>
<DL>
<DT><A HREF="#pg_connect">pg_Connect()</A>
<DT><A HREF="#pg_close">pg_Close()</A>
<DT><A HREF="#pg_host">pg_Host()</A>
<DT><A HREF="#pg_port">pg_Port()</A>
<DT><A HREF="#pg_options">pg_Options()</A>
<DT><A HREF="#pg_tty">pg_tty()</A>
<DT><A HREF="#pg_dbname">pg_DBname()</A>
<DT><A HREF="#pg_exec">pg_Exec()</A>
<DT><A HREF="#pg_result">pg_Result()</A>
<DT><A HREF="#pg_freeresult">pg_FreeResult()</A>
<DT><A HREF="#pg_getlastoid">pg_GetLastOid()</A>
<DT><A HREF="#pg_numrows">pg_NumRows()</A>
<DT><A HREF="#pg_numfields">pg_NumFields()</A>
<DT><A HREF="#pg_fieldnum">pg_FieldNum()</A>
<DT><A HREF="#pg_fieldname">pg_FieldName()</A>
<DT><A HREF="#pg_fieldtype">pg_FieldType()</A>
<DT><A HREF="#pg_fieldsize">pg_FieldSize()</A>
<DT><A HREF="#pg_fieldprtlen">pg_FieldPrtLen()</A>
</DL>
<P>
<STRONG>Note:</STRONG> Binary cursors are not supported.
</P>
<P>
In addition to these functions, PHP/FI can also be compiled to automatically
escape any forward single quote ( ' ) characters found in GET or POST data.
If the MAGIC_QUOTES variable is defined in the <EM>php.h</EM> file then
these quotes will be automatically escaped making it easier to pass
form data directly to Postgres95 queries.</P>
<P>
Here is a sample script that connects to Postgres95 database on localhost
called 'mydb' and retrieves the names and ages of people in a table:</P>
<P>
<PRE>
&lt;?
   $conn = pg_Connect("localhost", "5432", "", "", "mydb");
   if (!$conn) {
      echo "An error occured.\n";
      exit;
   }

   $result = pg_Exec($conn, "select * from table1");
   if (!$result) {
      echo "An error occured.\n";
      exit;
   }

   $num = pg_NumRows($result);
   $i = 0;

   while ($i &lt; $num) {
      echo "name: ";
      echo pg_Result($result, $i, "name");
      echo "  age: ";
      echo pg_Result($result, $i, "age");
      echo "&lt;BR&gt;";
      $i++;
   }

   pg_FreeResult($result);
   pg_Close($conn);
&gt;
</PRE></P>

<HR>
<A NAME="regexp"><H2>Regular Expressions</H2></A>
<P>
Regular expressions are used for complex string manipulation in PHP/FI.
The script interface to the regular expression support is through the following
functions: <A HREF="#reg_match">Reg_Match()</A>, <A HREF="#reg_replace">
Reg_Replace()</A>, and <A HREF="#reg_search">Reg_Search()</A>.  The first
argument to all three functions is a regular expression string.  This string
is made up of regular characters and special characters.  Regular characters
are matched exactly, while special characters have a special meaning.  The following
is the complete list of special characters and their meanings as understood by
the PHP/FI parser:</P>
<blockquote>
<DL>
<DT><STRONG>`.'</STRONG>
<DD> <P>is a special character that matches anything except a newline.
     Using concatenation, we can make regular expressions like `a.b'
     which matches any three-character string which begins with `a'
     and ends with `b'.</P>

<DT><STRONG>`*'</STRONG>
<DD> <P>is not a construct by itself; it is a suffix, which means the
     preceding regular expression is to be repeated as many times as
     possible.  In `fo*', the `*' applies to the `o', so `fo*'
     matches `f' followed by any number of `o''s.</P>
<P>
     The case of zero `o''s is allowed: `fo*' does match `f'.</P>
<P>
     `*' always applies to the *smallest* possible preceding
     expression.  Thus, `fo*' has a repeating `o', not a repeating
     `fo'.</P>
<P>
     The matcher processes a `*' construct by matching, immediately,
     as many repetitions as can be found.  Then it continues with the
     rest of the pattern.  If that fails, backtracking occurs,
     discarding some of the matches of the `*''d construct in case
     that makes it possible to match the rest of the pattern.  For
     example, matching `c[ad]*ar' against the string `caddaar', the
     `[ad]*' first matches `addaa', but this does not allow the next
     `a' in the pattern to match.  So the last of the matches of
     `[ad]' is undone and the following `a' is tried again.  Now it
     succeeds.</P>

<DT><STRONG>`+'</STRONG>
<DD>
<P>`+' is like `*' except that at least one match for the preceding
     pattern is required for `+'.  Thus, `c[ad]+r' does not match
     `cr' but does match anything else that `c[ad]*r' would match.</P>

<DT><STRONG>`?'</STRONG>
<DD>
<P>`?' is like `*' except that it allows either zero or one match
     for the preceding pattern.  Thus, `c[ad]?r' matches `cr' or
     `car' or `cdr', and nothing else.</P>

<DT><STRONG>`[ ... ]'</STRONG>
<DD>
<P>`[' begins a "character set", which is terminated by a `]'.  In
     the simplest case, the characters between the two form the set.
     Thus, `[ad]' matches either `a' or `d', and `[ad]*' matches any
     string of `a''s and `d''s (including the empty string), from
     which it follows that `c[ad]*r' matches `car', etc.</P>
<P>
     Character ranges can also be included in a character set, by
     writing two characters with a `-' between them.  Thus, `[a-z]'
     matches any lower-case letter.  Ranges may be intermixed freely
     with individual characters, as in `[a-z$%.]', which matches any
     lower case letter or `$', `%' or period.</P>
<P>
     Note that the usual special characters are not special any more
     inside a character set.  A completely different set of special
     characters exists inside character sets: `]', `-' and `^'.</P>
<P>
     To include a `]' in a character set, you must make it the first
     character.  For example, `[]a]' matches `]' or `a'.  To include
     a `-', you must use it in a context where it cannot possibly
     indicate a range: that is, as the first character, or
     immediately after a range.</P>

<DT><STRONG>`[^ ... ]'</STRONG>
<DD>
<P>`[^' begins a "complement character set", which matches any
     character except the ones specified.  Thus, `[^a-z0-9A-Z]'
     matches all characters *except* letters and digits.</P>
<P>
     `^' is not special in a character set unless it is the first
     character.  The character following the `^' is treated as if it
     were first (it may be a `-' or a `]').</P>

<DT><STRONG>`^'</STRONG>
<DD>
<P>is a special character that matches the empty string -- but only
    if at the beginning of a line in the text being matched.
    Otherwise it fails to match anything.  Thus, `^foo' matches a
    `foo' which occurs at the beginning of a line.</P>

<DT><STRONG>`$'</STRONG>
<DD>
<P>is similar to `^' but matches only at the end of a line.  Thus,
    `xx*$' matches a string of one or more `x''s at the end of a line.</P>

<DT><STRONG>`\'</STRONG>
<DD>
<P>has two functions: it quotes the above special characters
    (including `\'), and it introduces additional special constructs.</P>
<P>
    Because `\' quotes special characters, `\$' is a regular
    expression which matches only `$', and `\[' is a regular
    expression which matches only `[', and so on.</P>
<P>
    For the most part, `\' followed by any character matches only
    that character.  However, there are several exceptions:
    characters which, when preceded by `\', are special constructs.
    Such characters are always ordinary when encountered on their own.</P>
<P>
    No new special characters will ever be defined.  All extensions
    to the regular expression syntax are made by defining new
    two-character constructs that begin with `\'.</P>

<DT><STRONG>`\|'</STRONG>
<DD> <P>specifies an alternative.  Two regular expressions A and B with
     `\|' in between form an expression that matches anything that
     either A or B will match.</P>
<P>
     Thus, `foo\|bar' matches either `foo' or `bar' but no other
     string.</P>
<P>
     `\|' applies to the largest possible surrounding expressions.
     Only a surrounding `\( ... \)' grouping can limit the grouping
     power of `\|'.</P>
<P>
     Full backtracking capability exists when multiple `\|''s are used.</P>

<DT><STRONG>`\( ... \)'</STRONG>
<DD> <P>is a grouping construct that serves three purposes:</P>
<P>
       1. To enclose a set of `\|' alternatives for other operations.
          Thus, `\(foo\|bar\)x' matches either `foox' or `barx'.</P>
<P>
       2. To enclose a complicated expression for the postfix `*' to
          operate on.  Thus, `ba\(na\)*' matches `bananana', etc.,
          with any (zero or more) number of `na''s.</P>
<P>
       3. To mark a matched substring for future reference.</P>
<P>
     This last application is not a consequence of the idea of a
     parenthetical grouping; it is a separate feature which happens
     to be assigned as a second meaning to the same `\( ... \)'
     construct because there is no conflict in practice between the
     two meanings.  Here is an explanation of this feature:</P>

<DT><STRONG>`\DIGIT'</STRONG>
<DD> <P>After the end of a `\( ... \)' construct, the matcher remembers
     the beginning and end of the text matched by that construct.
     Then, later on in the regular expression, you can use `\'
     followed by DIGIT to mean "match the same text matched the
     DIGIT'th time by the `\( ... \)' construct."  The `\( ... \)'
     constructs are numbered in order of commencement in the regexp.</P>
<P>
     The strings matching the first nine `\( ... \)' constructs
     appearing in a regular expression are assigned numbers 1 through
     9 in order of their beginnings.  `\1' through `\9' may be used
     to refer to the text matched by the corresponding `\( ... \)'
     construct.  These 9 saved constructs are known as registers.</P>
<P>
     For example, `\(.*\)\1' matches any string that is composed of
     two identical halves.  The `\(.*\)' matches the first half,
     which may be anything, but the `\1' that follows must match the
     same exact text.</P>
<P>
     The saved constructs or registers may be used within a single
     expressions, or they may be extracted and used for something else.
     Addding a third argument to either reg_match() or reg_search() will
     define an array into which the 9 registers will be written.  An
     additional register is written at the beginning (position 0) which
     is the entire matched expression.  For example:</P>
     <P>
<PRE>    &lt;?$string = "This is a test";
      $cnt = reg_match("\(\w*\).*\(\<\\w*\)$",$string,$regs);
      echo $cnt;
      echo $regs[0];
      echo $regs[1];
      echo $regs[2];
    &gt;</PRE></P>
    <P>
     The above will first print the number of characters matched (14 in this case)
     and then the entire matched string, followed by the first word of the string
     and then the last word.</P>

<DT><STRONG>`\b'</STRONG>
<DD> <P>matches the empty string, but only if it is at the beginning or
     end of a word.  Thus, `\bfoo\b' matches any occurrence of `foo'
     as a separate word.  `\bball\(s\|\)\b' matches `ball' or `balls'
     as a separate word.</P>

<DT><STRONG>`\B'</STRONG>
<DD> <P>matches the empty string, provided it is <STRONG>not</STRONG> at
     the beginning or end of a word.</P>

<DT><STRONG>`\&lt;'</STRONG>
<DD> <P>matches the empty string, but only if it is at the beginning of
     a word.</P>

<DT><STRONG>`\&gt;'</STRONG>
<DD> <P>matches the empty string, but only if it is at the end of a word.</P>

<DT><STRONG>`\w'</STRONG>
<DD> <P>matches any word-constituent character.</P>

<DT><STRONG>`\W'</STRONG>
<DD> <P>matches any character that is not a word-constituent.</P>

<DT><STRONG>`\`'</STRONG>
<DD> <P>matches beginning of buffer</P>

<DT><STRONG>`\''</STRONG>
<DD> <P>matches end of buffer</P>
</DL>
</blockquote>

<HR>
<A NAME="script"><H2>PHP/FI Script Language</H2></A>
<P>
The PHP script language is similar in syntax to the C language in many ways.
It supports variables, arrays, function calls, different variable types
and most things you might need to write complex cgi programs.</P>
<P>
Each PHP/FI function is described in the following section and can be quickly
found by simply appending #function_name to the url for this document since
each function description has been tagged with its name.  </P>

<A NAME="syntax"><H3>Syntax</H3></A>
<P>
Each PHP instruction starts with <STRONG>&lt;?</STRONG> and ends with a
<STRONG>&gt;</STRONG>.  Or, instructions may be grouped inside a single
<STRONG>&lt;? &gt;</STRONG> pair and separated by <STRONG>;</STRONG> characters.</P>
<P>
Variables are supported and are indicated by preceding the
variable name with a <STRONG>$</STRONG>.  So, for example, to set a
variable to 5 and then display this variable, the following
is valid:</P>
<P>
<PRE>	&lt;?$a = 5&gt;
	&lt;?echo $a&gt;</PRE></P>
<P>
This is the same as writing:</P>
<P>
<PRE>	&lt?; $a = 5; echo $a &gt;</PRE>
<P>
Or even:</P>
<P>
<PRE>	&lt?;
	$a = 5;
	echo $a;
	&gt;</PRE></P>
<P>
Extra white space characters such as spaces, tabs and new-lines
are ignored.  This fact should be used to format the PHP script
blocks to make them easier to read.  Case is relevant in variable
names, but not in function calls.  In the functional overview later
on in this documentation, case is only used to make the function
names easier to read.  In the actual script language you can use
any case you wish.
</P>
<P>
Comments are supported.  A comment is written just like comments in
the C language.  <STRONG>/*</STRONG> starts a comment and <STRONG>*/</STRONG> ends a
comment.  Comments can be placed anywhere within the <STRONG>&lt;? ... &gt;</STRONG>
block.</P>
<HR>
<A NAME="vars"><H3>Variables</H3></A>
<P>
Three types of variables are supported.  <STRONG>Long integer</STRONG>,
<STRONG>Double precision floating point</STRONG> and <STRONG>character strings</STRONG>.
They are automatically detected.  For example:</P>
<P>
<PRE>	&lt;?$a = 5&gt;</PRE></P>
<P>
causes $a to become a variable of type INTEGER.</P>
<P>
<PRE>	&lt;?$a = 5.0&gt;</PRE></P>
causes $a to become a variable of type DOUBLE.</P>
<P>
<PRE>	&lt;?$a = "5"&gt;</PRE></P>
<P>
causes $a to become a variable of type STRING.</P>
<P>
The type of the variable is not generally important.  Every variable
regardless of its type is converted to all three types internally and
the various functions will try to use the correct type.  There are
only a few functions affected by the type of the variable.</P>
<P>
All three variable types may also be treated as arrays by appending
<STRONG>[value]</STRONG> to their names.  Unlike C, these are actually
associative arrays similar to those used in Perl.  The following would
be valid:</P>
<P>
<PRE>	&lt;?
	  $a[0] = 5;
	  $a["hello"] = 6;
	  echo $a[0];
	  echo $a["hello"];
	&gt;</PRE></P>
	<P>
Note that if a variable is used both as an array and as a normal variable,
the normal variable is synonymous with the index &quot;0&quot; entry in
the array.  ie.</P>
<P>
<PRE>    $a = 1;</PRE></P>
<P>
Is the same as writing:</P>
<P>
<PRE>    $a[0] = 1;</PRE></P>
<P>
PHP/FI also supports non-indexed arrays.  A non-indexed array will generate
its own index as items are added to it.  For example:</P>
<P>
<PRE>    $a[] = "Hello";
    $a[] = "There";</PRE></P>
    <P>
The first item inserted into a non-indexed array always gets assigned
index 0, the second index 1, etc.  Therefore the above items may be
printed out with:</P>
<P>
<PRE>    echo $a[0];
    echo $a[1];</PRE></P>
    <P>
You can use the <A HREF="#count">count()</A> function to determine the
number of items in any array.</P>
<P>
Also inherent to the language is the fact that the type of the variable
determines how certain basic operations will be carried out.  For example:</P>
<P>
<PRE>    $a = $b + $c;</PRE></P>
<P>
can do a couple of different things.  If $b is a number, the numerical
value of $c is added to $b and the sum is stored in $a.  In this case
the type of $c is irrelevant.  The operation is guided by the type of
the first variable.  If $b is a string, then the string value of
$c is appended to $b and the resultant string is placed in $a.
This also leads to some caveats.  You should read the
section on <A HREF="#overload">overloaded operators</A> to get a
better understanding of how to deal with them.</P>
<HR>
<A NAME="assoc"><H3>Associative Arrays</H3></A>
<P>
The previous section introduced associative arrays.  An associative array is an
array in which the index need not be a numerically sequential value.  The array
index can be any number or string.  PHP/FI provides a set of functions to
manipulate these associative arrays.  These include, <A HREF="#next">Next()</A>,
<A HREF="#prev">Prev()</A>,<A HREF="#reset">Reset()</A>,<A HREF="#end">End()</A>,
and <A HREF="#key">Key()</A>.</P>
<HR>
<A NAME="varvars"><H3>Variable Variables</H3></A>
<P>
Sometimes it is convenient to be able to have variable variable names.
That is, a variable name which can be set and used dynamically.
A normal variable is set with a statement such as:</P>
<P>
<PRE>    $a = "hello";</PRE></P>
<P>
A variable variable takes the value of a variable and treats that as the
name of a variable.  In the above example, <STRONG>hello</STRONG>, can
be used as the name of a variable by using two dollar signs. ie.</P>
<P>
<PRE>    $$a = "world";</PRE></P>
<P>
At this point two variables have been defined and stored in the PHP/FI
symbol tree:</P>
<P>
<PRE>    Variable Name        Variable Content
         <EM>a</EM>                   <EM>hello</EM>
         <EM>hello</EM>               <EM>world</EM></PRE></P>
         <P>
Therefore, this statement:</P>
<P>
<PRE>    echo "$a $$a";</PRE></P>
<P>
produces the exact same output as:</P>
<P>
<PRE>    echo "$a $hello";</PRE></P>
<P>
ie. they both produce: <STRONG>hello world</STRONG></P>
<HR>
<A NAME="lang"><H3>Language Constructs</H3></A>
<P>
As far as language constructs are concerned, the PHP language is
quite simple.  The following commands are used to guide the control
flow through a file:</P>
<P>
<UL>
	<LI>if (condition)
	<LI>else
	<LI>elseif (condition)
	<LI>endif
	<LI>switch(expression)
	<LI>case expression
	<LI>default
	<LI>break
	<LI>endswitch
	<LI>while
	<LI>endwhile
	<LI>include
	<LI>exit
</UL></P>
<P>
The syntax of conditions are similar to that of the C language.
<STRONG>==</STRONG> tests for equality.  <STRONG>!=</STRONG> means not equal.  Also
supported are: <STRONG>&gt;</STRONG>, <STRONG>&lt;</STRONG>, <STRONG>&gt;=</STRONG>,
<STRONG>&lt;=</STRONG>.
Conditional AND is <STRONG>&&</STRONG>, conditional OR is <STRONG>||</STRONG>.</P>

Examples:
<P>
<PRE>    &lt;?
      if($a==5 &&  $b!=0 );
        $c = 100 + $a / $b;
      endif;
    &gt;</PRE></P>
<P>The above may also be written in standard C syntax:</P>
<P>
<PRE>    &lt;?
      if($a==5 && $b!=0) {
          $c = 100 + $a / $b;
      }
    &gt;</PRE></P>
	<P>
There is no difference between the two syntaxes.  I personally like to
use endif, endswitch and endwhile so I explicitly know which construct 
I am ending.  However, these ending constructs can always be replaced with
a closing curly brace.</P><P>
It is important to note that the flow of the language is not dependent
on the organization of the script blocks within the code.  You can
start an if expression in one block and have the end of the expression
in another.  For example:</P>
<P>
<PRE>	&lt;?if($a==5 &&  $b!=0)>
		  &lt;b&gt;Normal html text&lt;/b&gt;
	&lt;?endif&gt;</PRE></P>
<P>In this example it is easy to see why it is sometimes more desirable to use
the <TT>endif</TT> keyword as opposed to a closing brace.  The above is much more readable
than the following:</P>
<P>
<PRE>	&lt;?if($a==5 &&  $b!=0) {>
		  &lt;b&gt;Normal html text&lt;/b&gt;
	&lt;? } &gt;</PRE></P>
<P>Both version are valid and they will do exactly the same thing.</P>
<HR>
<A NAME="user_funcs"><H3>User-Defined Functions</H3></A>
<P>You may define a function within a PHP script with the following syntax:</P>
<PRE>    &lt;?
      Function Test (
        echo "This is a test\n";
      );
    &gt;</PRE></P>
    <P>
This function can now be called from anywhere in the script as long as
the call comes after the function definition.  A sample call might be:</P>
<P>
<PRE>    &lt;?
      Test();
    &gt;</PRE></P>
    <P>
User defined functions like this act exactly like PHP's internal functions
in that you can pass arguments to them and have them return a value.  Here
is the syntax for a function definition of a function which takes 3 arguments
and returns the sum of these arguments:</P>
<P>
<PRE>    &lt;?
      Function Sum $a,$b,$c (
        return($a+$b+$c);
      );

      echo Sum($a,$b,$c);
    &gt;</PRE></P>
    <P>
The <EM>return</EM> statement is used to return a value from the function.  Only
a single value can be returned using this mechanism, however, if more values
need to be communicated back and forth between the main code and functions,
global variables can be used.  This brings us to the section on the scope of
variables.</P>

<HR>
<A NAME="scope"><H3>Scope of Variables</H3></A>
<P>
The scope of a variable is the context within which it is defined.  For the
most part all PHP/FI variables only have a single scope.  However, within
user-defined functions a local function scope is introduced.  Any variable
used inside a function is by default limited to the local function scope.
For example:</P>
<P>
<PRE>    $a=1; /* global scope */
    Function Test (
      echo $a; /* reference to local scope variable */
    );
    Test();</PRE></P>
    <P>
This script will not produce any output because the <EM>echo</EM>
statement refers to a local version of the <EM>$a</EM> variable, and it has
not been assigned a value within this scope.  You may notice that this is
a little bit different from the C language in that global variables in C
are automatically available to functions unless specifically overridden by a local
definition.  This can cause some problems in that people may inadvertently
change a global variable.  In PHP/FI global variables must be declared global
inside a function if they are going to be used in that function.  An example:</P>
<P>
<PRE>    $a=1;
    $b=2;
    Function Sum $first,$second (
      global $a,$b;

      $b = $a + $b;
    );
    Sum();
    echo $b;</PRE></P>
    <P>
The above script will output &quot;3&quot;.  By declaring $a and $b global within
the function, all references to either variable will refer to the global version.
There is no limit to the number of global variables that can be manipulated by a
function.  However, the variable must exist in the global scope prior to the
function being called.  You cannot create new global variables from within a function.</P>
<P>
Another important feature of variable scoping is the <EM>static</EM> variable.
A static variable exists only in a local function scope, but it does not lose
its value when program execution leaves this scope.  Consider the following
example:</P>
<P>
<PRE>    Function Test (
      $a=0;
      echo $a;
      $a++;
    );</PRE></P>
    <P>
This function is quite useless since every time it is called it sets $a to 0 and
prints &quot;0&quot;.  The $a++ which increments the variable serves no purpose
since as soon as the function exits the $a variable disappears.  To make a useful
counting function which will not lose track of the current count, the $a variable
s declared static:</P>
<P>
<PRE>    Function Test (
      static $a=0;
      echo $a;
      $a++;
    );</PRE></P>
    <P>
Now, everytime the Test() function is called it will print the value of $a and
increment it.</P>
<P>
Static variables are also essential when functions are called recursively.
A recursive function is one which calls itself.  Care must be taken when writing
a recursive function because it is possible to make it recurse indefitely.  You
must make sure you have an adequate way of terminating the recursion.  The
following simple function recursively counts to 10:</P>
<PRE>    Function Test (
      static $count=0;

      $count++;
      echo $count;
      if($count <  10) {
        Test();
      } 
    );</PRE></P>

<HR>
<A NAME="math"><H3>Mathematical Expressions</H3></A>
<P>
PHP supports full mathematical operations anywhere an expression is
expected.  Order of operations are taken into account.  The following
are the valid operators:</P>
<P>
<PRE>	&lt;? $a = 2 + 1 &gt; <EM>Addition</EM>
	&lt;? $a = 2 - 1 &gt; <EM>Subtraction</EM>
	&lt;? $a = 2 * 1 &gt; <EM>Multiplication</EM>
	&lt;? $a = 2 / 1 &gt; <EM>Division</EM>
	&lt;? $a = 2 % 1 &gt; <EM>Modulus</EM></PRE></P>
<P>
Both bracketing and order of operations is supported, so the following
is valid:</P>
<P>
<PRE>	&lt;?$a = (2+1)*3+6/3&gt;</PRE></P>
<P>
The C-like incremental operators <TT>+=</TT> and <TT>-=</TT> are
supported. ie.</P>
<P>
<PRE>    &lt;? $a += $b&gt;</PRE></P>
<P>
This is equivalent to:</P>
<P>
<PRE>    &lt;? $a = $a + $b&gt;</PRE></P>
<P>
The C-like bit-wise operators <TT>&amp;=</TT> and <TT>|=</TT> are
supported. ie.</P>
<P>
<PRE>    &lt;? $a &== 4&gt;</PRE>
This is equivalent to:</P>
<P>
<PRE>    &lt;? $a = $a &  4&gt;</PRE></P>
<HR>
<A NAME="while"><H3>While Loops</H3></A>
<P>
You can loop within a PHP script by using the <EM>while(); endwhile;</EM> construct.</P>
<P>
<PRE>	&lt;?
	  $a=0;
	  while($a<100) {
		  $a++;
		  echo $list[$a];	
	  } 
	&gt;<</PRE></P>
<P>
The above example shows the use of a while loop to display the contents of
an array.  <STRONG>WARNING</STRONG> although the PHP language supports incremental
operators such as <STRONG>++</STRONG> and <STRONG>--</STRONG> to increment and decrement
a variable, they are not treated exactly like they would be in the
C language.  The variable is incremented right away.  There is no
concept of incrementing the variable before or after the operation
as there is in C.</P>
<HR>
<A NAME="switch"><H3>Switch Construct</H3></A>
<P>
PHP supports a switch construct very similar to the C equivalent.</P>
<P>
<PRE>	&lt;?
	  $a=0;
	  switch($a) {
		case 1;
		  echo "a is 1";
		  break;
		case "hello";
		  echo "a is hello";
		  break;
		default;
		  echo "a is unknown";
		  break;
	  } 
	&gt;</PRE></P>
<P>
The above is an example of a switch construct.  It is similar to a
series of if/elseif/else constructs but easier to read.  The only
difference between the PHP switch construct and that of the C
language is that semi-colons are used to terminate every line.  There
are no colons.</P>
<P>
All of these constructs can of course be nested and used
inside each other just like C.  The various files in the <EM>examples</EM>
directory of the PHP distribution should provide a good starting point
for learning the language.</P>
<HR>
<A NAME="secure"><H3>Secure Variables - Defeating GET method hacks</H3></A>
<P>
A previous section talked about GET and POST method data and variables.
If you think about it, you may be able to envision a security issue.  For example,
if on a web page I have obtained some data from a database and I pass this
data along in a variable called &quot;data&quot; in a POST method form.  In the
ensuing page I can access this variable and do something with it.  However, if
someone accessed this second page directly and put a &quot;?data=something&quot

right in the URL thereby doing a GET method variable set, they have effectively
circumvented the original secure POST method form.</P>
<P>
PHP provides a <EM>SecureVar()</EM> function which is used to mark variables
names as being secure variables.  These secure variables can only be set
directly in a PHP script, or they can come from a POST method form.  They
cannot be set using the GET method variable definition mechanism.  From our
above scenario, if we placed the line:</P>
<P>
<PRE>    &lt;?SecureVar("data")&gt;</PRE></P>
<P>
Near the beginning of our second page, then the GET method trick would
not work.  The &quot;data&quot; variable would appear to be empty unless
it came directly from the POST method form on the first page.</P>
<P>
The <EM>SecureVar()</EM> actually takes a regular expression as its
argument, so you can mark patterns of variable names that should be
treated in this secure manner.  For example,</P>
<P>
<PRE>    &lt;?SecureVar(".*data.*")&gt;</PRE></P>
Would mark any variable with the word &quot;data&quot; anywhere in their
name as being secure.</P>
<HR>
<A NAME="overload"><H3>Overloaded Operators and dealing with variable types</H3></A>

An overloaded operator is an operator like '+' for example which can do different things
based on the types of the expressions it is asked to operate on.</P>

The problem is that PHP understands 3 variable types.  Integer,
Double and String.  When a variable is first assigned, PHP
automatically figures out the variable type.</P>
<P>
ie.
</P>
<P>
<PRE>    $a = 1;     Type would be integer
    $b = 1.5;   Type would be double
    $c = "1";   Type would be string</PRE></P>
<P>
Now, what happens when you do something like:</P>
<P>
<PRE>    $d = $a + $c;</PRE></P>
<P>
The parser looks at the first part of the
arithmetic expression and uses that to type the result and thus
also the nature of the arithmetic that is to be done.  In the
above case since $a is an integer, $d will be an integer and
an integer addition is done giving the result:</P>
<P>
<PRE>    $d = 2      Type is integer</PRE></P>
<P>
Therefore:</P>
<P>
<PRE>    $d = $c + $a</PRE></P>
<P>
Results in:</P>
<P>
<PRE>    $d = "11"   Type is string</PRE></P>
<P>
The above makes sense to me, and once you understand it, it is probably
workable.  However, when more complex expressions are used it can
get extremely confusing.</P>
<P>
The solution is a simple type casting mechanism.

In reality all variables are automatically converted to all
3 types, and an internal flag just marks what type the variable
actually is.  So, when I say:</P>

<PRE>    $a = 1;</PRE></P>
<P>
Internally in the symbol table I store 3 versions.
</P>
<P>
<PRE>    Integer:  1    <--- flag
    Double :  1.0
    String :  "1"</PRE></P>
<P>
The <EM>SetType()</EM> function can move this flag indicating the type of the variable.
</P>
<P>
<PRE>    SetType($a,"double");</PRE></P>
<P>
This would force $a to be treated as a double from then on.</P>
<P>
The <EM>GetType()</EM> function returns the type.

<TT>GetType($a)</TT> would return &quot;double&quot; in this case.</P>
<P>
Functions also exist to return the 3 various types without moving the type flag.
</P>
<P>
<PRE>    IntVal($a)     returns  1
    DoubleVal($a)  returns  1.0
    StrVal($a)     returns  "1"</PRE></P>
<P>
This doesn't change the overloaded operator nature of the PHP variables,
but it does give you some tools to better deal with them.  PHP is not
not a full-fledged Perl look-alike.  It
has to be small and fast.  Perl deals with the overloaded operator
pitfall by forcing something like the '+' operator to only
work on numbers.  If you want to add strings, you must use the
'.' operator.  Once you start having separate operators for each type
you start making the language much more complex.  ie. you can't use
'==' for stings, you now would use 'eq'.  I don't see the point,
especially for something like PHP where most of the scripts will
be rather simple and in most cases written by non-programmers who
want a language with a basic logical syntax that doesn't have too
high a learning curve.</P>
<HR>
<A NAME="quiet"><H3>Supressing Errors from function calls</H3></A>
<P>
It may be desirable in certain circumstances to ignore fatal
errors which may be reported by specific PHP functions.  For example,
you may want to ignore errors from a dbmopen() call and simply
check the return value of the call without having error messages
appear on the web screen.  This can be done by putting the &quot;@&quot;
character in front of the function call.  ie.</P>
<P>
<PRE>    $err_code = @dbmopen($filename,"w");</PRE></P>
<P>
The actual error message that would have been printed can be checked
by looking at the PHP internal variable, <STRONG>$phperrmsg</STRONG>.</P>
<P>
A more general approach to suppress error message printing is to use the
<A HREF="#seterrorreporting">SetErrorReporting()</A> function.  With
this function error printing can be disabled for entire blocks of code
by preceding the block with a call like:</P>
<P>
<PRE>    SetErrorReporting(0);</PRE></P>
<P>
This turns off all errors.  They can then be re-enabled later with:</P>
<P>
<PRE>    SetErrorReporting(1);</PRE></P>
<HR>
<A NAME="funcs"><H3>Internal Functions</H3></A>
<P>
PHP has a number of built-in functions.  Functions are called in
the same manner as they are called in the C language.  Some take
one or more arguments, and some return values which can then be
assigned to a variable or used as an argument to another function.
For example:</P>
<P>
<PRE>	&lt;?$t=time()&gt;</PRE></P>
<P>
This assigns the return value of the <EM>time()</EM> function to the
<EM>t</EM> variable.</P>
<H3>Alphabetical List of Functions</H3>
<DL>

<DT><A NAME="abs"><FONT SIZE=+1>Abs(arg)</FONT></A>
<DD>
<P>Abs returns the absolute value of arg.</P>

<DT><A NAME="bindec"><FONT SIZE=+1>BinDec(binary_string)</FONT></A>
<DD>
<P>BinDec returns the decimal equivalent of the binary number
represented by the binary_string argument.
The largest number that can be converted is
31 bits long or 4294967295 in decimal.  See also the
<A HREF="#decbin">DecBin()</A> function.</P>

<DT><A NAME="chdir"><FONT SIZE=+1>ChDir(dir)</FONT></A>
<DD>
<P>ChDir changes the current working directory to the directory
specified in the argument.</P>

<DT><A NAME="chgrp"><FONT SIZE=+1>ChGrp(file,group)</FONT></A>
<DD>
<P>ChGrp changes the group id of the specified file.</P>

<DT><A NAME="chmod"><FONT SIZE=+1>ChMod(file,perms)</FONT></A>
<DD>
<P>ChMod changes the file permissions of the specified file.  The <EM>perms</EM>
parameter must be specified in octal.</P>

<DT><A NAME="chown"><FONT SIZE=+1>ChOwn(file,owner)</FONT></A>
<DD>
<P>ChOwn changes the specified file to be owned by the specified owner.  Note
that this will only work if the PHP/FI binary is running as root (which is not
generally a good idea).</P>

<DT><A NAME="chr"><FONT SIZE=+1>Chr(arg)</FONT></A>
<DD>
<P>Chr returns the ASCII character represented by the integer argument.</P>

<DT><A NAME="closedir"><FONT SIZE=+1>closeDir()</FONT></A>
<DD>
<P>closeDir closes a directory opened using the <A HREF="#opendir">
openDir</A> function.</P>

<DT><A NAME="cos"><FONT SIZE=+1>Cos(arg)</FONT></A>
<DD>
<P>Sin returns the cosine of arg in radians.  See also <A HREF="#sin">Sin()</A>
and <A HREF="#tan">Tan()</A></P>

<DT><A NAME="count"><FONT SIZE=+1>Count(array)</FONT></A>
<DD>
<P>Count returns the number of items in an array variable.  If the
variable is not an array, the return value will be 1 (because a normal
variable is similar to an array with only one item).  If the variable
is not defined, the return value will be 0.</P>

<DT><A NAME="crypt"><FONT SIZE=+1>Crypt(string,[salt])</FONT></A>
<DD>
<P>Crypt will encrypt a string using the standard Unix DES
encryption method.  Arguments are a string to be encrypted and an optional
two-character salt string to base the encryption on.  See the Unix man page for
your crypt function for more information.  If you do not have a crypt function
on your Unix system, you can use Michael Glad's public domain UFC-Crypt package
which was developed in Denmark and hence not restricted by US export laws as long
as you ftp it from an non-US site.</P>

<DT><A NAME="date"><FONT SIZE=+1>Date(format,time)</FONT></A>
<DD>
<P>The Date function is used to display times and dates in various
ways.  The function takes a format string and a time as arguments.  If the
time argument is left off, the current time and date will be used.  The time
argument is specified as an integer in number of seconds since the Unix
Epoch on Jan.1 1970.  The format string is used to indicate which date/time
components should be displayed and how they should be formatted.  The following
characters are recognized within the format string.  Any unrecognized
character is printed verbosely:</P>
<TT>
<UL>
	<LI>Y - Year eg. 1995
	<LI>y - Year eg. 95
	<LI>M - Month eg. Oct
	<LI>m - Month eg. 10
	<LI>D - Day eg. Fri
	<LI>d - Day eg. 27
	<LI>z - Day of the year eg. 299
	<LI>H - Hours in 24 hour format eg. 13
	<LI>h - Hours in 12 hour format eg. 1
	<LI>i - Minutes eg. 5
	<LI>s - Seconds eg. 40
	<LI>U - Seconds since epoch eg. 814807830
</UL>
</TT></P>

<DT><A NAME="dblist"><FONT SIZE=+1>dbList()</FONT></A>
<DD>
<P>dbList outputs information about the db support compiled into PHP.</P>

<DT><A NAME="dbmclose"><FONT SIZE=+1>dbmClose(filename)</FONT></A>
<DD>
<P>dbmClose simply closes the specified dbm file.  It will also
unlock any lock files, so it is important to close any dbm files that
have been opened.</P>

<DT><A NAME="dbmdelete"><FONT SIZE=+1>dbmDelete(filename,key)</FONT></A>
<DD>
<P>dbmdelete will delete the key/content pair specified by the given key argument.</P>

<DT><A NAME="dbmfetch"><FONT SIZE=+1>dbmFetch(filename,key)</FONT></A>
<DD>
<P>dbmFetch will return the content string associated with the given key.</P>

<DT><A NAME="dbmfirstkey"><FONT SIZE=+1>dbmFirstKey(filename)</FONT></A>
<DD>
<P>dbmFirstKey returns the first key in the dbm file.  Note that no particular
order is guaranteed since the order depends on hash table values calculated within the
dbm implementation.  You may use the <A HREF="#sort">Sort</A> function to sort arrays of data
from the dbm file if necessary.</P>

<DT><A NAME="dbminsert"><FONT SIZE=+1>dbmInsert(filename,key,content)</FONT></A>
<DD>
<P>dbmInsert inserts a new key/content data pair into a dbm file.  If the
key already exists, the insert will fail.</P>

<DT><A NAME="dbmnextkey"><FONT SIZE=+1>dbmNextKey(filename,key)</FONT></A>
<DD>
<P>dbmNextKey returns the next key after the specified key.  By calling
<STRONG>dbmfirstkey()</STRONG>
followed by successive calls to <STRONG>dbmnextkey()</STRONG> it is possible to visit every
key/content
pair in the dbm file.</P>

<DT><A NAME="dbmopen"><FONT SIZE=+1>dbmOpen(filename,mode)</FONT></A>
<DD>
<P>dbmOpen() opens a dbm file.  The first argument is the full-path filename
of the dbm file to be opened and the second is the file open mode which is one
of <B>&quot;r&quot;</B>, <B>&quot;n&quot;</B> or <B>&quot;w&quot;</B> for
read, new (implies write) and write respectively.  If ndbm support is used, ndbm 
will actually create <EM>filename.dir</EM> and <EM>filename.pag</EM> files.  gdbm
only uses one file, as does the internal flat ascii file support, and
Berkeley's libdb create a <EM>filename.db</EM> file.  Note that
PHP does its own file locking in addition to any file locking that may be
done by the dbm library itself.  PHP does not delete the <EM>.lck</EM>
files it creates.  It uses these files simply as fixed inodes on which
to do the file locking.  For more information on dbm files, see your
Unix man pages, or obtain GNU's gdbm from
<A HREF="ftp://prep.ai.mit.edu/pub/gnu">ftp://prep.ai.mit.edu/pub/gnu</A>.</P>

<DT><A NAME="dbmreplace"><FONT SIZE=+1>dbmReplace(filename,key,content)</FONT></A>
<DD>
<P>dbmReplace is similar to the <STRONG>dbminsert()</STRONG> function, the only
difference being that if the key already exists, the old content string will
be replaced with the new.</P>

<DT><A NAME="decbin"><FONT SIZE=+1>DecBin(number)</FONT></A>
<DD>
<P>DecBin returns a string containing a binary representation of the
given number argument.  The largest number that can be converted is
31 bits long or 4294967295 in decimal.  See also the
<A HREF="#bindec">BinDec()</A> function.</P>

<DT><A NAME="dechex"><FONT SIZE=+1>DecHex(number)</FONT></A>
<DD>
<P>DecHex converts a decimal number to a hexadecimal string.  See also
the <A HREF="#hexdec">HexDec()</A> function.</P>

<DT><A NAME="decoct"><FONT SIZE=+1>DecOct(number)</FONT></A>
<DD>
<P>DecOct converts a decimal number to an octal number. See also
<A HREF="#octdec">OctDec()</A>.</P>

<DT><A NAME="doubleval"><FONT SIZE=+1>doubleval(variable)</FONT></A>
<DD>
<P>doubleval returns the double (floating point) value of the variable.
See also the <A HREF="#strval">strval()</A> and <A HREF="#intval">intval()</A>
functions.</P>

<DT><A NAME="echo"><FONT SIZE=+1>Echo [format_string] expression [, expression [,...]]</FONT></A>
<DD>
<P>Echo is not a function.  ie. you do not put brackets around the
arguments to it.  It is used to display results of
PHP functions or PHP variables.  The special escape characters,
<STRONG>\n</STRONG>, <STRONG>\r</STRONG> and <STRONG>\t</STRONG> can be used to output newlines,
carriage returns and tabs respectively.  The format_string is
optional and if not present, no output formatting will be done.
The format string is similar to the format string of the C <EM>printf</EM>
function.  See the man page for <EM>printf</EM> for more details.
Up to 5 expressions can be printed with a single echo command.  If you try 
to print more you will get a parser error.  Note that the types of the
expressions are not relevant.  The expressions are automagically converted to
the appropriate types as specified by the format string if one is present.
If you want to format something and assign
the formatted string to a variable instead of displaying it, use the
<A HREF="#sprintf">sprintf()</A> function.</P>
<P>The following conversions are supported,</P>
<BLOCKQUOTE>
<P>
<DL>
<DT>%d %i</DT>
<DD>Print a signed decimal number.</DD>
<DT>%o</DT>
<DD>Print an ocal number.</DD>
<DT>%u</DT>
<DD>Print an unsigned decimal number.</DD>
<DT>%x %X</DT>
<DD>Print a hexadecimal number.</DD>
<DT>%f</DT>
<DD>Print a floating-point number.</DD>
<DT>%e %E</DT>
<DD>Print a floating-point number in scientific notation.</DD>
<DT>%g %G</DT>
<DD>Print a floating-point number in scientific notation or normal notation,
as appropriate.</DD>
<DT>%c</DT>
<DD>Print a single character.</DD>
<DT>%s</DT>
<DD>Print a string of characters.</DD>
<DT>%%</DT>
<DD>Print a literal percent-sign.</DD>
</DL>
</P>
The following flags are accepted.
<DL>
<DT>'-'</DT>
<DD>Left-justify the output within the field-width.</DD>
<DT>'+'</DT>
<DD>Ensure that all integers are signed (with a plus/minus sign).</DD>
<DT>' '</DT>
<DD>Similar to '+', but uses a space instead of a plus-sign.</DD>
<DT>'#'</DT>
<DD>Print prefixes in front of hex and octal numbers designating them as
such.</DD>
<DT>'''</DT>
<DD>Separate the digits into groups (usually comma-separated groups of
three).</DD>
<DT>'0'</DT>
<DD>Pad the field-width with zeros.</DD>
</DL>
<P>
All of these flags are dependent upon wether or not your C library's printf
function supports them (the ''', for example, is a GNU extension).</P>
<P>
Most conversions will accept a field width and a precision, as shown in
the <TT>demo_echo.html</TT> file in the directory /examples.  It is not
necessary to specify any type modifiers, and, in fact, PHP will complain
if the type modifier does not make sense (which is almost always the
case).  PHP will complain about (and refuse to accept) anything that it
does not recognize.  Any extra arguments given that are not required
by the format-string are ignored.</P>
</BLOCKQUOTE>

<DT><A NAME="end"><FONT SIZE=+1>End(variable)</FONT></A>
<DD>
<P>End moves the internal array pointer for the given variable to the
last item of the array and returns the value of this item.
This is useful for traversing an associative
array in reverse order.  See also <A HREF="#reset">Reset()</A> and
<A HREF="#prev">Prev()</A>.  The following example would traverse an
associative array in reverse order:</P>
<P>
<PRE>    &lt;?
      Reset($array);
      $first_key = key($array);
      End($array);
      $k = key($array);
      while($k != $first_key);
        echo $array[$k];
        prev($array);
        $k = key($array);
      endwhile;
      echo $array[$k];
    &gt;</PRE></P>

<DT><A NAME="escapeshellcmd"><FONT SIZE=+1>EscapeShellCmd(string)</FONT></A>
<DD><P>EscapeShellCmd escapes any characters in a string that might be used to
trick a shell command into executing arbitrary commands.  This function should
be used to make sure that any data coming from user input is escaped before
this data is passed to the <A HREF="#exec">Exec()</A> or <A HREF="#system">System()</A>
functions.  A standard use would be:</P>
<P>
<PRE>    &lt;?system(EscapeShellCmd($cmd))&gt;</PRE></P>

<DT><A NAME="eval"><FONT SIZE=+1>Eval(string)</FONT></A>
<DD>
<P>Eval takes the contents of the string argument and treats it like a mini
PHP/FI script.  It will execute it as a separate PHP/FI script.  Any variables
set or accessed from inside the eval will be from the global reference frame
in the current context of the eval statement in the script.  Variable substitution
is done on the string arguments, so if variables are to be used in the string
expression they should be escaped.  Some examples:</P>
<P>
<PRE>    $a = "echo phpversion();";
    eval($a);

    eval("echo phpversion();");

    eval("\$a=1; echo \$a;");</PRE></P>

<DT><A NAME="exec"><FONT SIZE=+1>Exec(command_string [, array [,return_var]])</FONT></A>
<DD>
<P>Exec executes the given unix command, however it does not
output anything.  It simply returns the last line from the result of the command.
If the array argument is present, then the specified array will be filled
with every line of output from the unix command starting at array[0].  If the
return_var argument is present along with the array argument, then the return
status of the executed unix command will be written to this variable.  Note that if
you are going to allow data coming from user input to be passed to this Exec function,
then you should be using the <A HREF="#escpapeshellcmd">EscapeShellCmd()</A> function
to make sure that users cannot trick the system into executing arbitrary commands.
See also the <A HREF="#system">system()</A> function.</P>

<DT><A NAME="exit"><FONT SIZE=+1>Exit</FONT></A>
<DD>
<P>The Exit command is used to terminate parsing right away as soon
as this tag is parsed.</P>

<DT><A NAME="exp"><FONT SIZE=+1>Exp(arg)</FONT></A>
<DD>
<P>Exp returns e raised to the power of arg.</P>

<DT><A NAME="fclose"><FONT SIZE=+1>fclose(fd)</FONT></A>
<DD>
<P>fclose() closes a file opened by <A HREF="#fopen">fopen()</A>.
The argument is a file pointer index as returned by the fopen()
call.</P>

<DT><A NAME="feof"><FONT SIZE=+1>feof(fd)</FONT></A>
<DD>
<P>Feof returns true if the file referred to by the file pointer index
argument has hit end-of-file.</P>

<DT><A NAME="fgets"><FONT SIZE=+1>fgets(fd,bytes)</FONT></A>
<DD>
<P>fgets() reads a line from a file opened by <A HREF="#fopen">fopen()</A>.
Arguments are a file pointer index as returned by fopen() and the max number of
bytes to read.  Reading ends when max number of bytes have been read,
or on an end of line.  This is similar to the C fgets() call.
See also <A HREF="#fputs">fputs()</A>.</P>

<DT><A NAME="fgetss"><FONT SIZE=+1>fgetss(fd,bytes)</FONT></A>
<DD>
<P>Identical to the fgets() function, except this one tries to strip
off any HTML tags or PHP/FI script tags as it is reading the file.</P>

<DT><A NAME="file"><FONT SIZE=+1>$array = File(filename)</FONT></A>
<DD>
<P>File reads the entire file and returns an array with each array element
containing a line of the file starting with array index <STRONG>0</STRONG>.</P>

<DT><A NAME="fileatime"><FONT SIZE=+1>fileAtime(filename)</FONT></A>
<DD>
<P>fileAtime returns the time of last data access.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="filectime"><FONT SIZE=+1>fileCtime(filename)</FONT></A>
<DD>
<P>fileCtime returns the time of last status change.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="filegroup"><FONT SIZE=+1>fileGroup(filename)</FONT></A>
<DD>
<P>fileGroup returns the group id of the owner of the file.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="fileinode"><FONT SIZE=+1>fileInode(filename)</FONT></A>
<DD>
<P>fileInode returns the file's inode.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="filemtime"><FONT SIZE=+1>fileMtime(filename)</FONT></A>
<DD>
<P>fileMtime returns the time of last data modification.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="fileowner"><FONT SIZE=+1>fileOwner(filename)</FONT></A>
<DD>
<P>fileOwner returns the uid of the owner of the file.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="fileperms"><FONT SIZE=+1>filePerms(filename)</FONT></A>
<DD>
<P>filePerms returns the permission bits of the file.  This is the
<EM>st_mode</EM> field of the Unix C stat structure.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="filesize"><FONT SIZE=+1>fileSize(filename)</FONT></A>
<DD>
<P>fileSize returns the size of the file in bytes.  If the file does
not exist, or if it for some other reason could not be accessed,
this function returns -1.</P>

<DT><A NAME="fopen"><FONT SIZE=+1>fp = fopen(filename,mode)</FONT></A>
<DD>
<P>fopen() opens a file and returns a file pointer index.  If the file
could not be opened the function returns -1.  It is
similar to the C fopen() call.  The filename argument is the
relative or absolute path to the file to be opened, and the mode
argument is one of, "r", "r+", "w", "w+", "a", "a+".  See the
Unix man page on the fopen() call for more information.  See also
the <A HREF="popen">popen()</A> function description.</P>

<DT><A NAME="fputs"><FONT SIZE=+1>fputs(fp,string)</FONT></A>
<DD>
<P>fputs() writes a line to a file opened by <A HREF="#fopen">fopen()</A>.
Arguments are a file pointer index as returned by fopen() and the string to
write.  Note that the string argument may contain the special escape characters,
<STRONG>\n</STRONG>, <STRONG>\r</STRONG> and <STRONG>\t</STRONG> to output newlines, carriage returns
and tabs
respectively.  See also <A HREF="#fgets">fgets()</A>.</P>

<DT><A NAME="fseek"><FONT SIZE=+1>fseek(fp,pos)</FONT></A>
<DD>
<P>fseek() positions a file pointer identified by the
fd argument which is the return value of the <A HREF="#fopen">fopen()</A>
call.  The file pointer is positioned at the beginning of the file plus
the offset specified by the <STRONG>pos</STRONG> argument.  See also
<A HREF="#ftell">ftell()</A> and <A HREF="#rewind">rewind()</A>.</P>

<DT><A NAME="fsockopen"><FONT SIZE=+1>fp = fsockopen(hostname,port)</FONT></A>
<DD>
<P>fsockopen() opens a socket connection and returns a file
pointer index. This file pointer index can be used by
<A HREF="#fgets">fgets</A>, <A HREF="#fputs">fputs</A> and
<A HREF="#fclose">fclose</A>.  Arguments are a hostname and a port number.
Return values are: -3 if the socket couldn't be created, -4 if the dns
lookup on the hostname failed, -5 if the connection was refused or it timed
out, -6 if the actual fdopen() call failed or -7 if the setvbuf() call failed.
If the port number is 0, then the hostname argument will be treated as a filename
of a Unix domain socket if your operating system support Unix domain sockets.</P>

<DT><A NAME="ftell"><FONT SIZE=+1>pos = ftell(fp)</FONT></A>
<DD>
<P>ftell() returns the position of a file pointer identified by the
fp argument which is the return value of the <A HREF="#fopen">fopen()</A>
call.  The position can later be used as an argument to fseek().
See also <A HREF="#ftell">ftell()</A> and <A HREF="#rewind">rewind()</A>.</P>

<DT><A NAME="getaccdir"><FONT SIZE=+1>getAccDir()</FONT></A>
<DD>
<P>getAccDir returns the directory where PHP access configuration files
are kept.  The access configuration filenames come from the numerical user
id of the user whose access configurations they represent.</P>

<DT><A NAME="getenv"><FONT SIZE=+1>GetEnv(string)</FONT></A>
<DD>
<P>GetEnv returns the value of the environment value specified by <EM>string</EM>.
Normally this function is not used because environment variables are available
to PHP/FI directly.  If a reference is made to a variable which is not found in
the internal symbol table, then the environment space is automatically searched.
GetEnv should be used when it is necessary to ensure that an environment variable
has not been overwritten by normal PHP/FI variable.  Security mechanisms that
rely on http server-defined variables like REMOTE_ADDR and REMOTE_HOST should load
these variables using GetEnv as opposed to referencing them directly as $REMOTE_ADDR
to avoid someone making up a fake form and posting the data to your server and
thereby bypassing whatever security mechanism you might have.</P>

<DT><A NAME="gethostbyname"><FONT SIZE=+1>getHostByName(domain_name)</FONT></A>
<DD>
<P>getHostByName converts the given domain name into an IP address
in nnn.nnn.nnn.nnn format.</P>

<DT><A NAME="gethostbyaddr"><FONT SIZE=+1>getHostByAddr(ip_address)</FONT></A>
<DD>
<P>getHostByAddr converts the given IP address in nnn.nnn.nnn.nnn
format into a fully qualified domain name.</P>

<DT><A NAME="getlastaccess"><FONT SIZE=+1>getLastAccess()</FONT></A>
<DD>
<P>getLastAccess returns the date and time in unix time format of
the last time the current page was access.  This value can be passed to
the <A HREF="#date">Date()</A> function for formatting.  This function is
only available if PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="getlastbrowser"><FONT SIZE=+1>getLastbrowser()</FONT></A>
<DD>
<P>getLastBrowser returns the identification string of browser the
last user to access the current page used.  This function is only
available if PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="getlastemail"><FONT SIZE=+1>getLastEmail()</FONT></A>
<DD>
<P>getLastEmail returns the E-Mail address of the last user to access the
current page.  This function is only available if PHP was compiled
with Access Logging enabled.</P>

<DT><A NAME="getlasthost"><FONT SIZE=+1>getLastHost()</FONT></A>
<DD>
<P>getLastHost returns the hostname of the last user to access the
current page.  This function is only available if PHP was compiled
with Access Logging enabled.</P>

<DT><A NAME="getlastmod"><FONT SIZE=+1>getLastMod()</FONT></A>
<DD>
<P>getLastMod returns the date and time in unix time format of
the last time the current page was modified.  This value can be passed to
the <A HREF="#date">Date()</A> function for formatting.  This function is
only available if PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="getlastref"><FONT SIZE=+1>getLastref()</FONT></A>
<DD>
<P>getLastRef returns the URL of the referring document of the
last user to access the current page.  This function is only available if
PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="getlogdir"><FONT SIZE=+1>getLogDir()</FONT></A>
<DD>
<P>getLogDir returns the top-level directory under which PHP log
files can be found.  The actual log files are in directories
under this directory.  Each subdirectory is the numerical user id
of the user to whom the log files belong.  Then within each directory
a series of dbm log files are found, each with the numerical inode
of the file they represent as the primary component of the filename.</P>

<DT><A NAME="getmyinode"><FONT SIZE=+1>getMyInode()</FONT></A>
<DD>
<P>getMyInode returns the numerical inode of the current HTML file.</P>

<DT><A NAME="getmypid"><FONT SIZE=+1>getMyPid()</FONT></A>
<DD>
<P>getMyPid() returns the current process id of the php parsing
process.</P>

<DT><A NAME="getmyuid"><FONT SIZE=+1>getMyUid()</FONT></A>
<DD>
<P>getMyUid returns the numerical user id of the owner of the current
HTML file.</P>

<DT><A NAME="getrandmax"><FONT SIZE=+1>getRandMax()</FONT></A>
<DD>
<P>getRandMax returns the maximum random number the <A HREF="#rand">Rand</A>
function will return.  If the value returned does not seem to be accurate,
have a look in the php.h source file in the PHP distribution for more information.</P>

<DT><A NAME="getstartlogging"><FONT SIZE=+1>getStartLogging()</FONT></A>
<DD>
<P>getStartLogging returns the time and date in Unix time format when
logging commenced on the current page.  This is more accurate when mSQL-based
logging is used since a timestamp is kept in each log file.  For dbm-logging
the time returned is the time the user's log directory was created.</P>

<DT><A NAME="gettoday"><FONT SIZE=+1>getToday()</FONT></A>
<DD>
<P>getToday returns the total number of hits the current page has
had since 12 midnight local time.  This function is only available if
PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="gettotal"><FONT SIZE=+1>getTotal()</FONT></A>
<DD>
<P>getTotal returns the total number of hits the current page has
had since access logging was started on the page.  This function is
only available if PHP was compiled with Access Logging enabled.</P>

<DT><A NAME="gettype"><FONT SIZE=+1>GetType(variable)</FONT></A>
<DD>
<P>GetType returns the type of the variable.  The return value is a string
and it is one of, &quot;integer&quot;, &quot;double&quot; or &quot;string&quot;.
See also the <A HREF="#settype">SetType()</A> function</P>

<DT><A NAME="gmdate"><FONT SIZE=+1>gmDate(format,time)</FONT></A>
<DD>
<P>gmDate is identical to the <A HREF="#date">Date</A> function
except for the fact that it uses Greenwich Mean Time instead of the current
local time.</P>

<DT><A NAME="header"><FONT SIZE=+1>Header &quot;header_string&quot;</FONT></A>
<DD>
<P>The Header command is used at the top of an HTML file to send
raw HTTP header strings.  See the
<A HREF="http://www.w3.org/hypertext/WWW/Protocols/HTTP1.0/draft-ietf-http-spec.html">
HTTP Specification</A> for more information on raw http headers.</P>

<DT><A NAME="hexdec"><FONT SIZE=+1>HexDec(hex_string)</FONT></A>
<DD>
<P>HexDec converts a hexadecimal string to a decimal number.  See also
the <A HREF="#dechex">DecHex()</A> function.</P>

<DT><A NAME="htmlspecialchars"><FONT SIZE=+1>HtmlSpecialChars(string)</FONT></A>
<DD>
<P>HtmlSpecialChars converts any characters with ascii codes in the string
argument between 160 and 255 inclusive to their corresponding HTML Entity names.
The function returns the converted string.</P>

<DT><A NAME="imagearc"><FONT SIZE=+1>ImageArc(im, cx, cy, w, h, s, e, col)</FONT></A>
<DD>
<P>ImageArc draws a partial ellipse centered at cx,cy (top left is 0,0) in the
image represented by <A HREF="#imagecreate">im</A>.
w and h specifies the ellipse's width and height respectively
while the start and end points are specified in degrees indicated by the s and e arguments.
This function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagechar"><FONT SIZE=+1>ImageChar(im, size, x, y, c, col)</FONT></A>
<DD>
<P>ImageChar draws the character c in the image identified by
<A HREF="#imagecreate">im</A> at coordinates x,y (top left is 0,0) in colour col.  The
size argument can be 1, 2, 3, 4 or 5 indicating the size of the font to be used.  1 is
the smallest and 5 is the largest.  This function is only available if GD support
has been enabled in PHP.</P>

<DT><A NAME="imagecharup"><FONT SIZE=+1>ImageCharUp(im, size, x, y, c, col)</FONT></A>
<DD>
<P>ImageCharUp draws the character c vertically in the image identified by
<A HREF="#imagecreate">im</A> at coordinates x,y (top left is 0,0) in colour col.  The
size argument can be 1, 2, 3, 4 or 5 indicating the size of the font to be used.  1 is
the smallest and 5 is the largest.  This function is only available if GD support
has been enabled in PHP.</P>

<DT><A NAME="imagecolorallocate"><FONT SIZE=+1>col = ImageColorAllocate(im, red, green,
blue)</FONT></A>
<DD>
<P>ImageColorAllocate returns a colour identifier representing the colour composed of the
given RGB components.  The im argument is the return from the <A HREF="#imagecreate">
ImageCreate</A> function.  ImageColorAllocate must be called to create each colour that
is to be used in the image represented by im.  This function is only available if
GD support has been enabled in PHP.</P>

<DT><A NAME="imagecolortransparent"><FONT SIZE=+1>ImageColorTransparent(im, col)</FONT></A>
<DD>
<P>ImageColorTransparent sets the transparent colour in the im image to col.  im is
the image identifier returned by <A HREF="#imagecreate">ImageCreate</A> and col is the
colour identifier returned by <A HREF="#imagecolorallocate">ImageColorAllocate</A>.  This
function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagecopyresized"><FONT SIZE=+1>ImageCopyResized(dst_im, src_im, dstX, 
dstY, srcX, srcY, dstW, dstH, srcW, srcH )</FONT></A>
<DD>
<P>ImageCopyResized copies a rectangular portion of one image to another image.  
<EM>dst_im</EM> is the destination image, <EM>src_im</EM> is the source image identifier.
If the source and destination coordinates and width and heights differ, appropriate
stretching or shrinking of the image fragment will be performed.  The coordinates
refer to the upper left corner.  This function can be used to copy regions within the
same image (if <EM>dst_im</EM> is the same as <EM>src_im</EM>) but if the regions
overlap the results will be unpredictable.  This function is only available if
GD support has been enabled in PHP.</P>

<DT><A NAME="imagecreate"><FONT SIZE=+1>im = ImageCreate(x_size, y_size)</FONT></A>
<DD>
<P>ImageCreate returns an image identifier representing a blank image of size
x_size by y_size.  This function is only available if GD support has been
enabled in PHP.</P>

<DT><A NAME="imagecreatefromgif"><FONT SIZE=+1>im = ImageCreateFromGif(filename)</FONT></A>
<DD>
<P>ImageCreateFromGif returns an image identifier representing the image obtained
from the given <EM>filename</EM>.  This function is only available if GD support
has been enabled in PHP.</P>

<DT><A NAME="imagedestroy"><FONT SIZE=+1>ImageDestroy(im)</FONT></A>
<DD>
<P>ImageDestroy frees any memory associated with image im.  im is the image
identifier returned by the <A HREF="#imagecreate">ImageCreate</A> function.  This
function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagefill"><FONT SIZE=+1>ImageFill(im, x, y, col)</FONT></A>
<DD>
<P>ImageFill performs a flood fill starting at coordinate x,y (top left is 0,0) with
colour col in image im.  This function is only available if GD support has been
enabled in PHP.</P>

<DT><A NAME="imagefilledpolygon"><FONT SIZE=+1>ImageFilledPolygon(im, points, num_points,
col)</FONT></A>
<DD>
<P>ImageFilledPolygon creates a filled polygon in image
<A HREF="#imagecreate">im</A>.  points is a
PHP array containing the polygon's vertices.  ie. points[0] = x0, points[1] = y0, points[2] =
x1, points[3] = y1, etc.  num_points is the total number of vertices.  This function is
only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagefilledrectangle"><FONT SIZE=+1>ImageFilledRectangle(im, x1, y1, x2, y2,
col)</FONT></A>
<DD>
<P>ImageFilledRectangle creates a filled rectangle of colour col in image im starting at upper left
coordinate x1,y1 and ending at bottom right coordinate x2,y2.  0,0 is the top left
corner of the image.  This function is only available if GD support has been
enabled in PHP.</P>

<DT><A NAME="imagefilltoborder"><FONT SIZE=+1>ImageFillToBorder(im, x, y, border, col)</FONT></A>
<DD>
<P>ImageFillToBorder performs a flood fill whose border colour is defined by border.  The
starting point for the fill is x,y (top left is 0,0) and the region is filled with colour
col.  This function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagegif"><FONT SIZE=+1>ImageGif(im, filename)</FONT></A>
<DD>
<P>ImageGif creates the GIF file in filename from the image im.  The im argument is
the return from the <A HREF="#imagecreate">ImageCreate</A> function.  This function is
only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imageinterlace"><FONT SIZE=+1>ImageInterlace(im, interlace)</FONT></A>
<DD>
<P>ImageInterlace turns the interlace bit on or off.  If interlace is 1 the im image
will be interlaced, and if interlace is 0 the interlace bit is turned off.  This functions
is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imageline"><FONT SIZE=+1>ImageLine(im, x1, y1, x2, y2, col)</FONT></A>
<DD>
<P>ImageLine draws a line from x1,y1 to x2,y2 (top left is 0,0) in image
<A HREF="#imagecreate">im</A> of colour <A HREF="#imagecolorallocate">col</A>.
This function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagepolygon"><FONT SIZE=+1>ImagePolygon(im, points, num_points, col)</FONT></A>
<DD>
<P>ImagePolygon creates a polygon in image <A HREF="#imagecreate">im</A>.  points is a
PHP array containing the polygon's vertices.  ie. points[0] = x0, points[1] = y0, points[2] =
x1, points[3] = y1, etc.  num_points is the total number of vertices.  This function is
only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagerectangle"><FONT SIZE=+1>ImageRectangle(im, x1, y1, x2, y2, col)</FONT></A>
<DD>
<P>ImageRectangle creates a rectangle of colour col in image im starting at upper left coordinate
x1,y1 and ending at bottom right coordinate x2,y2.  0,0 is the top left
corner of the image.  This function is only available if GD support has been
enabled in PHP.</P>

<DT><A NAME="imagesetpixel"><FONT SIZE=+1>ImageSetPixel(im, x, y, col)</FONT></A>
<DD>
<P>ImageSetPixel draws a pixel at x,y (top left is 0,0) in image
<A HREF="#imagecreate">im</A> of colour <A HREF="#imagecolorallocate">col</A>.
This function is only available if GD support has been enabled in PHP.</P>

<DT><A NAME="imagestring"><FONT SIZE=+1>ImageString(im, size, x, y, s, col)</FONT></A>
<DD>
<P>ImageString draws the string s in the image identified by
<A HREF="#imagecreate">im</A> at coordinates x,y (top left is 0,0) in colour col.  The
size argument can be 1, 2, 3, 4 or 5 indicating the size of the font to be used.  1 is
the smallest and 5 is the largest.  This function is only available if GD support
has been enabled in PHP.</P>

<DT><A NAME="imagestringup"><FONT SIZE=+1>ImageStringUp(im, size, x, y, s, col)</FONT></A>
<DD>
<P>ImageStringUp draws the string s vertically in the image identified by
<A HREF="#imagecreate">im</A> at coordinates x,y (top left is 0,0) in colour col.  The
size argument can be 1, 2, 3, 4 or 5 indicating the size of the font to be used.  1 is
the smallest and 5 is the largest.  This function is only available if GD support
has been enabled in PHP.</P>

<DT><A NAME="include"><FONT SIZE=+1>Include filename</FONT></A>
<DD>
<P>The Include command can be used to insert other files into the current
html file.  This is extremely handy for headers and footers which may need
to be included in hundreds of HTML files.  By using an include command you then
only need to modify the header or footer file in one place when it needs to be
changed.  Since full PHP parsing is done on the included file, you can also
use the include command to include common PHP scripts you may have written.  Sort
of like having a primitive shared library of scripts you can call from your HTML
file.</P>

<DT><A NAME="intval"><FONT SIZE=+1>intval(variable)</FONT></A>
<DD>
<P>intval returns the long integer value of the variable.  See also
the <A HREF="#strval">strval()</A> and <A HREF="#doubleval">doubleval()</A>
functions.</P>

<DT><A NAME="isset"><FONT SIZE=+1>IsSet(variable)</FONT></A>
<DD>
<P>The IsSet function returns 1 if the given variable is defined,
and 0 if it isn't.</P>

<DT><A NAME="key"><FONT SIZE=+1>Key(variable)</FONT></A>
<DD>
<P>Key returns the key of the current array item.  The current item is
determined by the position of the array pointer for the given variable.
This array pointer may be manipulated with the <A HREF="#reset">Reset()</A>,
<A HREF="#end">End()</A>, <A HREF="#next">Next()</A>, and <A HREF="#prev">Prev()</A>
functions.  This function is mainly used for determining the key value for
an item in an associative array, although it will work for normal array as well.</P>

<DT><A NAME="log"><FONT SIZE=+1>Log(arg)</FONT></A>
<DD>
<P>Log returns the natural logarithm of arg.</P>

<DT><A NAME="log10"><FONT SIZE=+1>Log10(arg)</FONT></A>
<DD>
<P>Log10 returns the base-10 logarithm of arg.</P>

<DT><A NAME="max"><FONT SIZE=+1>Max(array)</FONT></A>
<DD>
<P>Max returns the maximum value of a PHP array.  ie. it will search through
the entire array looking for the max element.  If it is an array of strings,
the returned string is the string which would be alphabetically last in the
array if it were sorted.</P>

<DT><A NAME="microtime"><FONT SIZE=+1>Microtime()</FONT></A>
<DD>
<P>Microtime() returns a string "msec sec" where sec is number of seconds
since 00:00 GMT, Jan 1, 1970, and msec is the microseconds part (as fraction of
seconds). Ex "0.87633900 825010464".  This function is only available on
operating systems that support the gettimeofday() system call.</P>

<DT><A NAME="min"><FONT SIZE=+1>Min(array)</FONT></A>
<DD>
<P>Min returns the minimum value of a PHP array.  ie. it will search through
the entire array looking for the min element.  If it is an array of strings,
the returned string is the string which would be alphabetically first in the
array if it were sorted.</P>

<DT><A NAME="mkdir"><FONT SIZE=+1>MkDir(dir,mode)</FONT></A>
<DD>
<P>MkDir creates a directory.  The <EM>mode</EM> parameter must be
given in octal notation.</P>

<DT><A NAME="mktime"><FONT SIZE=+1>MkTime(hour,min,sec,mon,day,year)</FONT></A>
<DD>
<P>MkTime returns a time in Unix timestamp (long integer) format which
corresponds to the date and time specified by the arguments.  Arguments may be
left out in which case the given component is set to the current value
according to the current local time and date.  These left out arguments may only
be left out from right to left.  ie. <TT>MkTime(hour,min,sec)</TT> is valid,
but <TT>MkTime(mon,day,year)</TT> is not valid.</P>

<DT><A NAME="msql"><FONT SIZE=+1>$result = msql(database,query)</FONT></A>
<DD>
<P>msql sends an mSQL query.  Arguments are the database name and the query
string.  ie. <STRONG><TT>&lt;?msql(&quot;MyDatabase&quot;quot;select * from
table&quot;)&gt</TT></STRONG>.
The return value from this function is a result identifier to be used to access the results
from the other msql_ functions.  A result identifier is a positive integer.  The function
returns <STRONG>0</STRONG> when no result identifier is created.  This is the case with
any queries that do not return anything, such as <EM>create</EM>, <EM>update</EM>,
<EM>drop</EM>, <EM>insert</EM> and
<EM>delete</EM>. The function will return <STRONG>-1</STRONG> if an error occurs.  A string
describing the error will be placed in $phperrmsg, and unless the function was called
as <STRONG>@msql()</STRONG> then this error string will also be printed out.
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_connect"><FONT SIZE=+1>msql_connect(hostname)</FONT></A>
<DD>
<P>msql_Connect specifies the host name or IP on which the mSQL database
engine resides.  This is equivalent to the msqlConnect() function in the mSQL C
API.  The one difference between this function and the C API equivalent is that
if the function isn't called, a connection to the local host is made by default
on the first call to the msql() function.  And, there is no need for an msql_close
function since only one connection may be active at any one time.  If a second call
to msql_connect() is made in a file, then the connection to the first host is
automatically closed.  To explicitly connect to the msql daemon on the local host, use:
<STRONG><TT>&lt;?msql_connect(&quot;localhost&quot;)&gt<</TT></STRONG><BR>This function is only
available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_createdb"><FONT SIZE=+1>msql_CreateDB(database)</FONT></A>
<DD>
<P>msql_CreateDB creates the given database.</P>

<DT><A NAME="msql_dbname"><FONT SIZE=+1>msql_dbName(result,i)</FONT></A>
<DD>
<P>msql_dbName returns the database name stored in position <EM>i</EM> of
the result pointer returned from the <A HREF="#msql_listdbs">msql_ListDbs()</A>
function.  The <A HREF="#msql_numrows">msql_NumRows()</A> function can
be used to determine how many database names are available.</P>

<DT><A NAME="msql_dropdb"><FONT SIZE=+1>msql_DropDB(database)</FONT></A>
<DD>
<P>msql_DropDB deletes the given mSQL database.  Use this with caution
as all data in the database will be lost.</P>

<DT><A NAME="msql_fieldflags"><FONT SIZE=+1>msql_FieldFlags(result,i)</FONT></A>
<DD>
<P>msql_FieldFlags returns the field flags of the specified field.
Currently this is either, "not null", "primary key", a combination
of the two or "" (an empty string).
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_fieldlen"><FONT SIZE=+1>msql_FieldLen(result,i)</FONT></A>
<DD>
<P>msql_FieldLen returns the length of the specified field.
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_fieldname"><FONT SIZE=+1>msql_FieldName(result,i)</FONT></A>
<DD>
<P>msql_FieldName returns the name of the specified field.  Arguments to the
function is the result identifier and the field index.  ie. <TT>msql_FieldName(result,2);</TT>
will return the name of the second field in the result associated with the result
identifier.  This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_fieldtype"><FONT SIZE=+1>msql_FieldType(result,i)</FONT></A>
<DD>
<P>msql_FieldType is similar to the msql_FieldName() function.  The arguments are
identical, but the field type is returned.  This will be one of "int", "char" or "real".
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_freeresult"><FONT SIZE=+1>msql_FreeResult(result)</FONT></A>
<DD>
<P>msql_FreeResult only needs to be called if you are worried about using
too much memory while your script is running.  All result memory will automatically
be freed when the script is finished.  But, if you are sure you are not going to
need the result data anymore in a script, you may call msql_freeresult with the
result identifier as an argument and the associated result memory will be freed.
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_listdbs"><FONT SIZE=+1>$result = msql_ListDBs()</FONT></A>
<DD>
<P>msql_ListDBs will return a result pointer containing the databases
available from the current mSQL daemon.  Use the <A HREF="#msql_dbname">
msql_dbName()</A> function to traverse this result pointer.</P>

<DT><A NAME="msql_listtables"><FONT SIZE=+1>$result = msql_ListTables(database)</FONT></A>
<DD>
<P>msql_ListTables takes a database name and result pointer much like the
<A HREF="#msql">msql()</A> function.  The <A HREF="#msql_tablename">msql_TableName()</A>
function should be used to extract the actual table names from the result pointer.</P>

<DT><A NAME="msql_numfields"><FONT SIZE=+1>msql_NumFields(result)</FONT></A>
<DD>
<P>msql_NumFields returns the number of fields in a result.  The argument is
the result identifier returned by the msql() function.
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_numrows"><FONT SIZE=+1>msql_NumRows(result)</FONT></A>
<DD>
<P>msql_NumRows simply returns the number of rows in a result.  The argument
is the result identifier returned by the msql() function.
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_regcase"><FONT SIZE=+1>msql_RegCase(string)</FONT></A>
<DD>
<P>msql_RegCase takes a string argument and converts it to the regular
expression needed to send to mSQL in order to get a case insensitive
match.  This turns a string like &quot;abc&quot  into &quot;[Aa][Bb][Cc]&quot;.</P>

<DT><A NAME="msql_result"><FONT SIZE=+1>msql_Result(result,i,field)</FONT></A>
<DD>
<P>msql_Result displays a field from a returned record.  Arguments are the result
identifier returned by the msql() function, an integer which is the index of the record
to be viewed and a field name.  The field argument supports the &quot;table.field&quot;
syntax for handling results from a join.  This function is perhaps best illustrated with
a complete example:</P>
<P>
<PRE>
    &lt;?
      $name = &quot;bob&quot;;	
      $result = msql($database,&quot;select * from table where firstname='$name'&quot;);
      $num = msql_numrows($result);
      echo &quot;$num records found!&ltp&p&gt;&quot;;
      $i=0;
      while($i<$$num);
        echo msql_result($result,$i,&quot;fullname&quot;);
        echo &quot;&ltbr&br&gt&&quot;;
        echo msql_result($result,$i,&quot;address&quot;);
        echo &quot;&ltbr&br&gt&&quot;;
        $i++;
      endwhile;
    &gt;</PRE></P>
<P>
The above script connects to the mSQL engine on the local machine, sets the <EM>name</EM>
variable to <EM>bob</EM> and sends a query which asks for all the fields from a
table where the <EM>firstname</EM> field is set to <EM>bob</EM>.  It then displays the
number of records it found after which it loops through each of the found
records and displays the <EM>fullname</EM> and <EM>address</EM> fields for each record.
As you can see, it would be trivial to add HTML markup tags around the printed
fields to format the results in a table or in whatever manner is desired.  Note
that there is no msql_connect() call.  msql_connect need only be called if a connection
to a remote database is desired.</P>
<P>
This function is only available if mSQL support has been enabled in PHP.</P>

<DT><A NAME="msql_tablename"><FONT SIZE=+1>msql_TableName(result,i)</FONT></A>
<DD>
<P>msql_TableName takes a result pointer returned by the <A HREF="#msql_listtables">
msql_ListTables()</A> function as well as an integer index and returns the name of
a table.  The <A HREF="#msql_numrows">msql_NumRows()</A> function may be used to
determine the number of tables in the result pointer.  An example would be:</P>
<P>
<PRE>
    &lt;?
      $result = msql_listtables(&quot;dbname&quot;);
      $i=0;
      while($i <  msql_numrows($result));
        $tb_names[$i]=msql_tablename($result, $i);
        echo $tb_names[$i];
        echo "&lt;BR&gt;";
        $i++;
      endwhile;
    &gt;</PRE></P>

<DT><A NAME="next"><FONT SIZE=+1>Next(variable)</FONT></A>
<DD>
<P>Next moves the internal array pointer to the next item in the array.
This happens automatically when an array is accessed using the non-indexed
method ($array[]).  The function returns the value of the new item.
This function can be used to move the pointer forward
without having to access the array explicitly.  One use would be to traverse
an associative array and only printing out the keys of the array and not
the actual contents.</P>
<P>
<PRE>    &lt;?
      Reset($array);
      $i=0;
      while($i &lt; count($array));
        echo key($array);
        next($array);
        $i++;
      endwhile;
    &gt;</PRE></P>

<DT><A NAME="octdec"><FONT SIZE=+1>OctDec(octal_number)</FONT></A>
<DD>
<P>OctDec converts an octal number to a decimal number. See also
<A HREF="#decoct">DecOct()</A>.</P>

<DT><A NAME="opendir"><FONT SIZE=+1>openDir(directory)</FONT></A>
<DD>
<P>openDir opens the specified directory and places an internal
pointer to the beginning of the directory.  Directory entries
are read using the <A HREF="#readdir">readDir</A> function, and an
opened directory should be closed with the <A HREF="#closedir">
closeDir</A> function.</P>

<DT><A NAME="ord"><FONT SIZE=+1>Ord(arg)</FONT></A>
<DD>
<P>Ord returns the ASCII value of the first character of arg.</P>

<DT><A NAME="pclose"><FONT SIZE=+1>pclose(fp)</FONT></A>
<DD>
<P>Pclose closes a pipe opened using the <A HREF="#popen">popen()</A>
function.</P>

<DT><A NAME="pg_close"><FONT SIZE=+1>pg_Close(connection_id)</FONT></A>
<DD>
<P>pg_Close will close down the connection to a Postgres95 database
assocated with the given connection identifier.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_connect"><FONT SIZE=+1>$connection = pg_Connect(host, port, options, tty,
dbname)</FONT></A>
<DD>
<P>pg_Connect opens a connection to a Postgres95 database.  Each
of the arguments should be a quoted string, including the port number.
The options and tty arguments are optional and can be empty strings.
This function returns a connection_id.  This identifier is needed by other
Postgres95 functions.  You can have multiple connections open at once.
This function will return <STRONG>0</STRONG> on error.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_dbname"><FONT SIZE=+1>pg_DBname(connection_id)</FONT></A>
<DD>
<P>pg_DBname will return the name of the database that the given
Postgres95 connection identifier is connected to.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_exec"><FONT SIZE=+1>$result = pg_Exec(connection_id, query_string)</FONT></A>
<DD>
<P>pg_Exec will send an SQL statement to the Postgres95 database specified by
the connection_id.  The connection_id must be a valid identifier
that was returned by pg_Connect.  The return value of this function
is an identifier to be used to access the results from other
Postgres95 functions.  This function will return <STRONG>0</STRONG> on error.
It will return <STRONG>1</STRONG> when the command executed correctly but
are not expected to returned data (insert or update commands, for
example).  Note that selects which return no data will still return a
valid result greater than 1.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_fieldname"><FONT SIZE=+1>pg_FieldName(result_id, field_number)</FONT></A>
<DD>
<P>pg_FieldName will return the name of the field occupying the
given column number in the given Postgrs95 result identifier.  Field numbering
starts from 0.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_fieldprtlen"><FONT SIZE=+1>pg_FieldPrtLen(result_id, row_number,
field_name)</FONT></A>
<DD>
<P>pg_FieldPrtLen will return the actual printed length (number of
characters) of a specific value in a Postgres95 result.  Row numbering starts at 0. This function
will return <STRONG>-1</STRONG> on an error.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_fieldnum"><FONT SIZE=+1>pg_FieldNum(result_id, field_name)</FONT></A>
<DD>
<P>pg_FieldNum will return the number of the column slot that
corresponds to the named field in the given Postgres95 result identifer.  Field
numbering starts at 0. This function
will return <STRONG>-1</STRONG> on error.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_fieldsize"><FONT SIZE=+1>pg_FieldSize(result_id, field_name)</FONT></A>
<DD>
<P>pg_FieldSize will return the internal storage size (in bytes) of
the named field in the given Postgres95 result.  A field size of 0 indicates
a variable length field. This function
will return <STRONG>-1</STRONG> on error.</P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_fieldtype"><FONT SIZE=+1>pg_FieldType(result_id, field_number)</FONT></A>
<DD>
<P>pg_FieldType will return a string containing the type name of
the given field in the given Postgres95 result identifier.  Field numbering starts at 0.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_freeresult"><FONT SIZE=+1>pg_FreeResult(result_id)</FONT></A>
<DD>
<P>pg_FreeResult only needs to be called if you are worried about using
too much memory while your script is running. All result memory will
automatically be freed when the script is finished. But, if you are
sure you are not going to need the result data anymore in a script,
you may call pg_freeresult with the result identifier as an
argument and the associated result memory will be freed.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_getlastoid"><FONT SIZE=+1>pg_GetLastOid()</FONT></A>
<DD>
<P>pg_GetLastOid can be used to retrieve the Oid assigned to an
inserted tuple if the last command sent via pg_Exec was an
SQL Insert.  This function will return a positive integer if
there was a valid Oid.  It will return <STRONG>-1</STRONG> if an error
occured or the last command sent via pg_Exec was not an Insert.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_host"><FONT SIZE=+1>pg_Host(connection_id)</FONT></A>
<DD>
<P>pg_Host will return the host name the the given Postgres95
connection identifier is connected to.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_numfields"><FONT SIZE=+1>pg_NumFields(result_id)</FONT></A>
<DD>
<P>pg_NumFields will return the number of fields (columns) in
a Postgres95 result.  The argument is a valid result identifier returned
by pg_Exec. This function
will return <STRONG>-1</STRONG> on error.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_numrows"><FONT SIZE=+1>pg_NumRows(result_id)</FONT></A>
<DD>
<P>pg_NumRows will return the number of rows in a Postgres95 result.  The argument
is a valid result identifier returned by pg_Exec. This function
will return <STRONG>-1</STRONG> on error.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_options"><FONT SIZE=+1>pg_Options(connection_id)</FONT></A>
<DD>
<P>pg_Options will return a string containing the options specified
on the given Postgres95 connection identifier.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_port"><FONT SIZE=+1>pg_Port(connection_id)</FONT></A>
<DD>
<P>pg_Port will return the port number that the given Postgres95
connection identifier is connected to.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_result"><FONT SIZE=+1>pg_Result(result_id, row_number, field_name)</FONT></A>
<DD>
<P>pg_Result will return values from a result identifier
produced by pg_Exec.  The row_number and field name specify what
cell in the table of results to return. Row numbering starts from
0.</P>
<P>
Postgres95 has many built in types and only the basic ones are
directly supported here.  All forms of integer, boolean and oid
types are returned as integer values.  All forms of float, and real
types are returned as double values.  All other types, including
arrays are returned as strings formatted in the same default Postgres95
manner that you would see in the 'monitor' or 'psql' programs.</P>
<P>
Support for returning PHP arrays of numerical and string data
from a Postgres95 result is planned for a later date.</P>
<P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="pg_tty"><FONT SIZE=+1>pg_tty(connection_id)</FONT></A>
<DD>
<P>pg_tty will return the tty name that server side debugging output
is sent to on the given Postgres95 connection identifier.</P>
This function is only available if Postgres95 support has been enabled in PHP.</P>

<DT><A NAME="phpinfo"><FONT SIZE=+1>phpInfo()</FONT></A>
<DD>
<P>phpInfo prints the same page you get when adding &quot;?info&quot;
to a PHP/FI parsed URL or when you run the php.cgi binary by itself.  It
is especially useful for debugging scripts in the Apache module version since
it displays a number of useful internal data.</P>

<DT><A NAME="phpversion"><FONT SIZE=+1>phpVersion()</FONT></A>
<DD>
<P>phpVersion returns the version number of PHP/FI currently running.</P>

<DT><A NAME="popen"><FONT SIZE=+1>fp = popen(command,mode)</FONT></A>
<DD>
<P>Popen opens a pipe to a command and returns a file pointer index.
This file pointer index can be used by
<A HREF="#fgets">fgets</A>, <A HREF="#fputs">fputs</A> and
<A HREF="#fclose">fclose</A>.  Arguments are the command to run and
the mode.  The mode can be either &quot;r&quot; for read or &quot;w&quot;
for write.  See the UNIX C library popen man page for more details.
Any file opened with popen() should be closed using the 
<A HREF="#pclose">pclose()</A> function.</P>

<DT><A NAME="prev"><FONT SIZE=+1>Prev(variable)</FONT></A>
<DD>
<P>Prev moves the internal array pointer for the given variable to the
previous item in the array.  If already at the beginning of the list,
the pointer will point to the first item.  The function returns the value
of the new item.  This function is useful for
traversing an associative array in reverse order.  See the example
in the <A HREF="#end">End()</A> definition.  Also see <A HREF="#next">Next()</A>.</P>

<DT><A NAME="putenv"><FONT SIZE=+1>PutEnv(string)</FONT></A>
<DD>
<P>PutEnv puts the given string in the environment.  Not extremely useful
since the local environment variables are wiped out when PHP is done with
a page, but in some cases it is useful if other things called from within
a PHP script checks environment variables.  For example, if you want to
run multiple mSQL daemon processes, you will need to use PutEnv to switch
back and forth between the different sockets.</P>

<DT><A NAME="quotemeta"><FONT SIZE=+1>QuoteMeta(arg)</FONT></A>
<DD>
<P>QuoteMeta returns a string composed of arg with any regular expression
special characters escaped with a backslash.</P>

<DT><A NAME="rand"><FONT SIZE=+1>Rand()</FONT></A>
<DD>
<P>Rand returns a random number between 0 and RANDMAX.  RANDMAX can be
determined with the <A HREF="#getrandmax">getRandMax</A> function.  Normally
a specific range is chosen by simply using the modulus operator on the result.</P>

<DT><A NAME="readdir"><FONT SIZE=+1>readDir()</FONT></A>
<DD>
<P>readDir reads the next entry from the currently open
directory structure.  Once an entry is read, the pointer is
advanced to the next entry in the directory and the
next call to this function will return the next entry in the
directory.  Use the <A HREF="#opendir">openDir</A>
function to open a directory before calling this function.</P>

<DT><A NAME="reg_match"><FONT SIZE=+1>reg_Match(expr,arg[,regs])</FONT></A>
<DD>
<P>reg_Match returns non-zero if the regular expression is matched
in the argument string.  For example, the condition, <TT>&lt;?if (reg_match(&quot;^This.*&quot;,
&quot;This is an example string&quot;)&gt;</TT> would be true since the &quot;^This.*&quot;
expression says to match the word <STRONG>This</STRONG> at the beginning of the string and then
match any characters afterwards.  If the <EM>regs</EM> argument is present, then match
registers are filled into positions 0-10 in the array named by the <EM>regs</EM>
argument.  For more information on regular expressions, see
the <A HREF="#regexp">regular expression section</A> of this document.</P>

<DT><A NAME="reg_replace"><FONT SIZE=+1>reg_replace(expr,replace,arg)</FONT></A>
<DD>
<P>reg_Replace scans the entire argument string and replaces any portions
of the string matched by the given expression with the replacement string.  For
example, in the string, <TT>&quot;This is an example string&quot;</TT> we could
very easily replace every space with a dash with the command:
<STRONG>reg_replace(" ","-","This is an example string")</STRONG>.For more information on regular
expressions, see the <A HREF="#regexp">regular expression section</A>
of this document.</P>

<DT><A NAME="reg_search"><FONT SIZE=+1>reg_Search(expr,arg[,regs])</FONT></A>
<DD>
<P>reg_Search will scan the entire argument string for any matches to
the given regular expression.  If a match is found, it will return the portion
of the string starting at where the match occurred.  If no match is found a
zero-length string is returned.  If the <EM>regs</EM> argument is present, then match
registers are filled into positions 0-10 in the array named by the <EM>regs</EM>
argument.  For more information on regular expressions, see
the <A HREF="#regexp">regular expression section</A> of this document.</P>

<DT><A NAME="rename"><FONT SIZE=+1>Rename(old,new)</FONT></A>
<DD>
<P>Rename filename old to new.  Similar to the Unix C
rename() function.</P>

<DT><A NAME="reset"><FONT SIZE=+1>Reset(variable)</FONT></A>
<DD>
<P>Reset moves the internal array pointer for the given array variable to
the first item of the array and returns the value of this item.
This is useful for traversing associative
and non-indexed arrays.  See also <a href-"#end">End()</A> and <A HREF="#next">Next()</A>.
The following example traverses an associative array:</P>
<P>
<PRE>    &lt;?
      Reset($array);
      $i=0;
      while($i &lt; count($array));
        echo $array[]; /* pointer automatically moves ahead one */
        $i++;
      endwhile;
    &gt;</PRE></P>

<DT><A NAME="return"><FONT SIZE=+1>return(value)</FONT></A>
<DD>
<P>Return exits the current function call and returns the specified value
back to the caller.  See the section on <A HREF="#user_funcs">User-Defined Functions</A>
for more information.</P>

<DT><A NAME="rewind"><FONT SIZE=+1>rewind(fd)</FONT></A>
<DD>
<P>rewind() resets a file pointer identified by the
fd argument which is the return value of the <A HREF="#fopen">fopen()</A>
call.  The file pointer is positioned at the beginning of the file.
See also <A HREF="#ftell">ftell()</A> and <A HREF="#fseek">fseek()</A>.</P>

<DT><A NAME="rewinddir"><FONT SIZE=+1>rewindDir()</FONT></A>
<DD>
<P>rewindDir moves the current directory pointer back to the
beginning of the directory.  Use the <A HREF="#opendir">openDir</A>
function to open a directory before calling this function.</P>

<DT><A NAME="seterrorreporting"><FONT SIZE=+1>SetErrorReporting(arg)</FONT></A>
<DD>
<P>SetErrorReporting sets the current error reporting state to the
value of <EM>arg</EM>.  If non-zero, errors will be printed, and if 0
they won't be.  The function returns the previous error reporting state.
This is a more general way of disabling error
reporting than by preceding individual functions with a '@' character.
See the section on
<A HREF="#quiet">Supressing Errors from function calls</A> for more
information.</P>

<DT><A NAME="setlogging"><FONT SIZE=+1>SetLogging(arg)</FONT></A>
<DD>
<P>SetLogging() either enables or disables the logging of access
statistics for a page.  If <EM>arg</EM> is
non-zero, logging will be enabled, if zero, disabled.</P>

<DT><A NAME="setshowinfo"><FONT SIZE=+1>SetShowInfo(arg)</FONT></A>
<DD>
<P>SetShowInfo() either enables or disables the information footer
at the bottom of all pages loaded through PHP.  If <EM>arg</EM> is
non-zero, the footers will be enabled, if zero, disabled.</P>

<DT><A NAME="settype"><FONT SIZE=+1>SetType(variable,type)</FONT></A>
<DD>
<P>SetType sets the type of a variable.  The type argument
is one of, &quot;integer&quot;, &quot;double&quot; or &quot;string&quot;.
See also the <A HREF="#gettype">GetType()</A> function.</P>

<DT><A NAME="sin"><FONT SIZE=+1>Sin(arg)</FONT></A>
<DD>
<P>Sin returns the sine of arg in radians.  See also <A HREF="#cos">Cos()</A>
and <A HREF="#tan">Tan()</A></P>

<DT><A NAME="sleep"><FONT SIZE=+1>Sleep(secs)</FONT></A>
<DD>
<P>Sleep will delay for secs seconds.  Similar to the Unix C sleep()
function.  See also the <A HREF="#usleep">USleep()</A> function.</P>

<DT><A NAME="sort"><FONT SIZE=+1>Sort(array)</FONT></A>
<DD>
<P>Sort is used to sort a PHP array in ascending order.  It understands
the three variable types and will sort alphabetically if the array
contains strings, and numerically if the array contains numbers.  In
the case of an array which contains a mixture of types, the first type
in the array will specify the sort method.</P>

<DT><A NAME="sprintf"><FONT SIZE=+1>Sprintf(format,arg)</FONT></A>
<DD>
<P>Sprintf returns the string created by the formatted output defined
by the format argument and arg.  It is similar to the formatted version
of the <A HREF="#echo">echo</A> command, except this just returns the
string while echo displays it.  It is also similar to the C function
by the same name.  The difference being that this version does not
accept multiple <EM>arg</EM> arguments.  If you need to format multiple
arguments into a single string, simply call sprintf() once for each
argument.  Note that the type of the argument doesn't affect the
output.  The argument type is automagically converted to match the
type specified in the format string.</P>

<DT><A NAME="sqrt"><FONT SIZE=+1>Sqrt(arg)</FONT></A>
<DD>
<P>Sqrt returns the square root of arg.</P>

<DT><A NAME="srand"><FONT SIZE=+1>Srand(integer)</FONT></A>
<DD>
<P>Srand seeds the random number generator.  This function takes
any integer as an argument.  One choice for a seed value is to use the 
<STRONG>date</STRONG> function to give you the current number of seconds 
past the minute.  Note that this function <B>does not return a value</B>!  
This function simply seeds the random number generator for subsequent calls 
to the <A HREF="#rand">rand()</A> function.  eg.<P>
<PRE>	&lt;?srand(date(&quot;s&quot))&gt;</PRE></P>

<DT><A NAME="strchr"><FONT SIZE=+1>strchr(string,arg)</FONT></A>
<DD>
<P>strchr and <A HREF="#strstr">strstr</A> are actually identical functions.  They
can be used interchangebly and both are included for completeness sake.
They will return the portion of the string argument starting at the point
where the given sub-string is found.  For example, in the string,
&quot;This is an example string&quot; above, the call:
<TT>&lt;echo strstr($string,&quot;an &quot;)&gt;</TT> would
return the string: <TT>&quot;an example string&quot;</TT>.</P>

<DT><A NAME="strlen"><FONT SIZE=+1>strlen(string)</FONT></A>
<DD>
<P>strlen returns the length of the string.</P>

<DT><A NAME="strrchr"><FONT SIZE=+1>strrchr(string,arg)</FONT></A>
<DD>
<P>strrchr will search for a single character starting at the end of the
argument string and working its way backwards.  It returns the string
starting with the search character if the character was found and an
empty string if it wasn't.</P>

<DT><A NAME="strstr"><FONT SIZE=+1>strstr(string,arg)</FONT></A>
<DD>
<P>strstr and <A HREF="#strchr">strchr</A> are actually identical functions.  They
can be used interchangebly and both are included for completeness sake.
They will return the portion of the string argument starting at the point
where the given sub-string is found.  For example, in the string,
&quot;This is an example string&quot; above, the call:
<TT>&lt;echo strstr($string,&quot;an &quot;)&gt;</TT> would
return the string: <TT>&quot;an example string&quot;</TT>.</P>

<DT><A NAME="strtok"><FONT SIZE=+1>strtok(string,arg)</FONT></A>
<DD>
<P>strtok is used to tokenize a string.  That is, if you have a string like
<STRONG>&quot;This is an example string&quot;</STRONG> you could tokenize this string into
its individual words by using the space character as the token.  You would use
the following script code:
<P>
<PRE>	&lt;?
	  $string = &quot;This is an example string&quot;;
	  $tok = strtok($string,&quot; &quot;);
	  while($tok);
		  echo "Word=$tok&lt;br&gt;";
		  $tok = strtok(&quot; &quot;);
	  endwhile;
	&gt;</PRE></P>
Note that only the first call to strtok uses the string argument.  Every
subsequent call to strtok only needs the token to use, as it keeps track of where
it is in the current string.  To start over, or to tokenize a new string you
simply call strtok with the string argument again to initialize it.</P>	

<DT><A NAME="strtolower"><FONT SIZE=+1>strtolower(string)</FONT></A>
<DD>
<P>strtolower converts the string argument to all lower case characters.</P>

<DT><A NAME="strtoupper"><FONT SIZE=+1>strtoupper(string)</FONT></A>
<DD>
<P>strtoupper converts the string argument to all upper case characters.</P>

<DT><A NAME="strval"><FONT SIZE=+1>strval(variable)</FONT></A>
<DD>
<P>strval returns the string value of the variable.  See also
the <A HREF="#intval">intval()</A> and <A HREF="#doubleval">doubleval()</A>
functions.</P>

<DT><A NAME="substr"><FONT SIZE=+1>substr(string, start, length)</FONT></A>
<DD>
<P>substr returns a part of the given string.  The start position is given
by the start argument.  The first position in a string is position 0.  And the
length argument specifies the number of characters to return from the start
position.</P>

<DT><A NAME="system"><FONT SIZE=+1>System(command_string [,return_var])</FONT></A>
<DD>
<P>System is just like the C <EM>system()</EM> command in that it executes
the given unix command and outputs the result.  If a variable is provided as
the second argument, then the return status code of the executed unix command
will be written to this variable.  Note, that if
you are going to allow data coming from user input to be passed to this System function,
then you should be using the <A HREF="#escpapeshellcmd">EscapeShellCmd()</A> function
to make sure that users cannot trick the system into executing arbitrary commands.
See also the <A HREF="#exec">Exec</A> function.</P>

<DT><A NAME="tan"><FONT SIZE=+1>Tan(arg)</FONT></A>
<DD>
<P>Sin returns the tangent of arg in radians.  See also <A HREF="#sin">Sin()</A>
and <A HREF="#cos">Cos()</A></P>

<DT><A NAME="tempnam"><FONT SIZE=+1>TempNam(path, prefix)</FONT></A>
<DD>
<P>TempNam returns a unique filename located in the directory indicated
by path with filename prefix given by prefix.  It is identical to the
Unix C tempnam() function.</P>

<DT><A NAME="time"><FONT SIZE=+1>Time()</FONT></A>
<DD>
<P>Time simply returns the current local time in seconds
since Unix epoch (00:00:00 Jan. 1 1970).  It is equivalent to calling
<A HREF="#date">Date(&quot;U&quot;)</A>.  If you need better than per-second
granularity, use the <A HREF="#microtime">Microtime</A> function.</P>

<DT><A NAME="unlink"><FONT SIZE=+1>Unlink(filename)</FONT></A>
<DD>
<P>Unlink deletes the given filename.  Similar to the Unix C unlink() function.</P>

<DT><A NAME="unset"><FONT SIZE=+1>UnSet($var)</FONT></A>
<DD>
<P>UnSet undefines the given variable.  In the case of an array, the entire
array is cleared.  Note that individual array elements can not be undefined
with this command.</P>

<DT><A NAME="urlencode"><FONT SIZE=+1>UrlEncode(arg)</FONT></A>
<DD>
<P>UrlEncode encodes any characters from arg which are not one of
&quot;a-zA-Z0-9_-.&quot; by replacing them with %xx where xx is their
ASCII value in hexadecimal.  The encoded string is returned.</P>

<DT><A NAME="usleep"><FONT SIZE=+1>USleep(microsecs)</FONT></A>
<DD>
<P>Sleep will delay for the given number of microseconds.  Similar to the Unix C usleep()
function.  See also the <A HREF="#sleep">Sleep()</A> function.</P>

</DL>
<HR>
<A NAME="addfunc"><H2>Adding your own internal functions to PHP/FI</H2></A>
It may well be that the set of functions provided by PHP/FI does not
include a particular function that you may need.  By carefully following
the steps described below, it is possible for you to add your own
functions to PHP/FI.</P>
<P>
Before you start hacking away at the internals of PHP/FI you need to
grab a copy of the latest version of Bison.  Bison is GNU's implementation
of YACC (Yet Another Compiler Compiler).  The YACC that came with your
operating system may or may not be good enough, but just to make sure,
go grab Bison.  You can find it at <A HREF="ftp://prep.ai.mit.edu/pub/gnu">
ftp://prep.ai.mit.edu/pub/gnu</A>.</P>
<P>
You should also have a look at the Makefile and turn on debugging.  Simply
uncomment the <STRONG>DEBUG</STRONG> line in the Makefile.  The output file
of debug information is specified by <STRONG>DEBUG_FILE</STRONG> in <EM>php.h</EM>.
It is by default set to <EM>/tmp/php.err</EM>.  You can change this to
suit your needs.</P>
<P>
A final thing you might want to keep in mind is that php runs as the
same user id as httpd on your system, unless of course you are running it
with the setuid bit set, and this httpd user does not generally have
write access to the various directories.  This means that if you do something
that causes php to core dump, you will not get a core file.  The easy way
around this is to make the directory where you keep your test .html files
writable to all.  PHP changes its current directory to the directory of
the .html file it is reading and will thus dump its core there if it can.</P>
<P>
In the following steps we will use the <EM>Time()</EM> function to
illustrate how to add a function.</P>

<DL><DT><STRONG>Step 1 - Defining the grammar of your Function</STRONG>
<DD>
<P>If your function takes 0 to 6 arguments, there are predefined
grammars available.  You can skip this step.</P>

<P>The grammar of your function is defined in the <EM>parse.raw</EM> file.
The first thing to add is a token.  A token is an upper case keyword
which is usually the same as your function name.  All the tokens are
defined near the top of the parse.raw file.  The order doesn't matter.
Then you need to build your actual YACC grammar rule.  Look at the 
existing rules and find a function that is similar to the one you are adding.
Keep in mind that most normal functions are standard functions that read their
arguments from the expression stack.  Your function will most likely fall into
this group in which case you won't need to touch the <EM>parse.raw</EM> file.</P>

<DT><STRONG>Step 2 - Adding your function to the lexical analyzer hash table</STRONG>
<DD>
<P>To do this, edit <EM>lex.c</EM> and find the hash table near the top of the
file.  Look for the line, <TT>static cmd_table_t cmd_table[22][30] = {</TT>,
which defines the beginning of the hash table.  The <TT>[22][30]</TT> defines
the size of the 2 dimensional array which holds the hash table.  The 22 is one
greater than the maximum function name length and the 30 refers to the
maximum number of functions in any one hash list.  If you exceed either of
these limits, simply increase them right here.</P>
This hash table would probably rate as the absolute simplest hash table in
the entire world.  The hash value is the length of the string of
the function name to be hashed.  So, for our <EM>Time()</EM> example, we
need to add an entry for hash value 4.  Therefore we add the following
line to the hash list for 4:</P>
<P>
<PRE>      { &quot;time&quot;,INTFUNC0,UnixTime },</PRE></P>
<P>
This entry maps a string to the INTFUNC0 token.  You can look up the grammar for
the INTFUNC0 token in <EM>parse.raw</EM> and you will see that it is a generic
grammar for an internal function call with 0 arguments.  The string,
in quotes above, is the actual string that you will be using in the .html files
to call your function.  Keep in mind that PHP/FI function names are
<STRONG>not</STRONG> case sensitive.  And the final <B>UnixTime</B> element is the
actual function to be called.</P>

<DT><STRONG>Step 3 - Write your actual Function</STRONG>
<DD>
<P>You can actually write your function in any language you like, as long
as it is callable through the normal C function call convention and you
have a way of creating either an object file or a library file compatible
with the linker on your system.  In general, we will assume that you are
writing your function in C.  All the functions that come with PHP/FI have
been written in C.  The Time() function, or UnixTime() as it is called
internally in PHP can be found in <EM>date.c</EM> and looks like this:</P>
<P>
<PRE>void UnixTime(void) {
    char temp[32];

    sprintf(temp,"%ld",(long)time(NULL));
    Push(temp,LNUMBER);
}</PRE></P>
<P>
Note that the function is void.  This indicates that it doesn't return
anything.  This may seem confusing to you because obviously the function
needs to somehow return the time.  The time is returned, but not as the
return value of the function.  It is pushed onto what is called an
expression stack.  The expression stack is simply a stack of strings
and an associated type.  PHP/FI understands only 3 basic variable types:
STRING, LNUMBER and DNUMBER.  STRING is a character string, LNUMBER is
a long integer and DNUMBER is a double, or floating point, value.  In
this Time() example, the value to be returned is the time expressed in
Unix format (number of seconds since Jan.1 1970) and is thus an integer.
The expression stack only accepts strings, so we sprintf the long integer
into a string and push it onto the stack indicating that it is actually
a long integer with the line: <TT>Push(temp,LNUMBER);</TT></P>

<DT><STRONG>Step 4 - Add your function prototype to php.h</STRONG>
<DD>
<P>In the bottom half of the <EM>php.h</EM> file you will find a
complete list of prototypes of all the functions in php.  They are
grouped by the files in which they appear.  Simply add your prototype
to an appropriate place in this file.  For our Time() example the
following line is added:</P>
<P>
<PRE>void UnixTime(void);</PRE></P>

<DT><STRONG>Step 5 - Compile</STRONG>
<DD>
<P>You have to remember to re-make the parser whenever you make a change
to the <EM>parse.raw</EM> file.  Type: <STRONG>make parser</STRONG> to
do this.  Then do a normal compile by typing: <STRONG>make</STRONG>
once that is done.</P>

<DT><STRONG>Step 6 - Send me your additions!</STRONG>
<DD>
<P>If you would like your functions added to the next release of
PHP/FI, send them to me.  The best way is probably to make a context-sensitive
diff.  To do that, you need a copy of a clean unmodified distribution.  Simply
do a, <STRONG>diff -c</STRONG> on the files you have changed comparing them
to the original files.  Please don't send me a diff of the changes in
<EM>parse.c</EM> since that file is automatically generated.  Send me the diff
from <EM>parse.raw</EM> instead.</P>
</DL>
<P>
The Time() example illustrated the steps involved in adding a function.
Chances are that the function you wish to add is quite a bit more
complex than this example.  You will probably want to be able to pass
arguments to your function and have it manipulate these arguments in
some manner.  You may even want to have it callable in different ways.
These concepts will be illustrated by the PHP/FI crypt() function.
See also the section entitled <A HREF="#hacknotes">Notes for Code Hacks</A>
for some more technical details about writing code for PHP/FI.</P>
<P>
The Crypt() Grammar in <EM>parse.raw</EM>:</P>
<P>
<PRE>%token CRYPT
        .
        .
        .
    | CRYPT '(' expr ',' expr ')'
        {
            if(GetCurrentState(NULL) || inCase || inElseIf) Crypt(1);
        }
    | CRYPT '(' expr ')'
        {
            if(GetCurrentState(NULL) || inCase || inElseIf) Crypt(0);
        }</PRE></P>
<P>
Here it is shown how to define a grammar which lets you call a function
with either 1 or 2 arguments.  You could write different functions
to handle the two cases, or simply send a mode parameter as is done
here to indicate the mode in which the function is called.  Note that in
this case you cannot use one of the pre-defined INTFUNCn grammars since your
function can take a variable number of arguments.</P>
<P>
The other aspect that is shown is how to actually represent function
arguments.  In most cases you will want to use the <STRONG>expr</STRONG>
identifier.  This identifier means that the argument is an expression.
An expression can be a literal value, a function call or a combination
of many expressions.  See parse.raw for the complete yacc grammar
definition for expressions for more details.</P>
<P>
The Hash Table entry in <EM>lex.c</EM>:</P>

<P>
<PRE>      { "crypt",CRYPT,NULL },</PRE></P>
<P>
Notice that the last item is a NULL in this case since the function call is
handled in <EM>parse.raw</EM> directly.  If you used an INTFUNCn grammar, then
you would put the name of your function in place of this NULL.  The actual 
Crypt() function in <EM>crypt.c</EM>:</P>

<P>
<PRE>/*
 * If mode is non-zero, a salt is expected.
 * If mode is zero, a pseudo-random salt will be selected.
 */
void Crypt(int mode) {
#if HAVE_CRYPT
	Stack *s;
	char salt[8];
	char *enc;
	
	salt[0] = '\0';
	if(mode) {
		s = Pop();
		if(!s) {
			Error("Stack error in crypt");
			return;
		}
		if(s->strval) strncpy(salt,s->strval,2);
	}
	s = Pop();
	if(!s) {
		Error("Stack error in crypt");
		return;
	}
	if(!salt[0]) {
		salt[0] = 'A' + (time(NULL) % 26);
		salt[1] = 'a' + (time(NULL) % 26);
		salt[2] = '\0';
	}
	enc = (char *)crypt(s->strval,salt);
#if DEBUG
	Debug("Crypt returned [%s]\n",enc);
#endif
	Push(enc,STRING);	

#else
	Error("No crypt support compiled into this version");
#endif
}</PRE></P>
<P>
The most important aspect of this function is the <STRONG>s = Pop()</STRONG>
call.  The arguments to the function must be popped off the expression
stack one by one.  When you write a function which takes multiple
arguments, remember that a stack is a LAST-IN, FIRST-OUT data structure.
This means that you will be popping your arguments off the stack in
reverse order.  The last argument is popped off first.  In the above
example we check to see if we are in the 2 argument mode.  If we are,
we pop the argument off the stack and save it.  Then we pop the next
argument off the stack.  Pop() returns a pointer to a Stack structure (s).
The Stack structure looks like this (from <EM>php.h</EM>):</P>
<P>
<PRE>/* Expression Stack */
typedef struct Stack {
    short type;
    unsigned char *strval;
    long intval;
    double douval;
    VarTree *var;
    struct Stack *next;
} Stack;</PRE></P>
<P>
The <EM>type</EM> will generally be one of STRING, LNUMBER or DNUMBER.
The <EM>strval</EM>, <EM>intval</EM>, and <EM>douval</EM> components are
the string, integer and double representations of the value respectively.
If the expression is actually a defined variable, the <EM>var</EM> component
contains a pointer to the variable structure which defines this variable.</P>
<P>
In our Crypt() function we are only interested in the string value of
the argument, so we use <EM>s->strval</EM>.  Many PHP/FI functions can
do different things depending on the type of the variable simply by
checking <EM>s->type</EM> and using <EM>s->strval</EM>, <EM>s->intval</EM>
and/or <EM>s->douval</EM> appropriately.</P>
<P>
After calling the <STRONG>real</STRONG> crypt() function and getting the
encrypted string, our Crypt() function calls <EM>Push(enc,STRING);</EM>
to push the return value onto the expression stack.  It should be noted
that the expression stack is cleared after each PHP/FI line, so if
you push expressions onto this stack that are never popped by anything,
it won't matter.</P>
<P>
The <EM>Debug()</EM> call in the Crypt() example shows how to add debugging
output to your function.  Debug() is a varags (variable argument list)
function just like printf.</P>
</P>
<HR>
<A NAME="hacknotes"><H2>Notes for Code-Hacks</H2></A>
<P>Memory management within PHP/FI is a tricky thing.  Since we can run as 
a server module, we have to be very careful about memory resources.  Not
only do we need to be reentrant, but we also need to be handle the fact
that we can receive a timeout signal at any time at which point we drop out
of the module.  We get no warning, and we get no time to free any memory
that we may have allocated.  And this memory has to be freed, or the data
space of the httpd process we are linked to could grow indefinitely.
This also applies when PHP is running in CGI mode since it can be set up
to run as a FastCGI persistent process.</P>
<P>The solution is to use sub-pools of memory.  These pools are
automatically cleared by Apache when a session is terminated, or in the case
of a FastCGI persistent process, these pools are cleared in <EM>main.c</EM>
every time the FastCGI wrapper loop executes.  Three such
pools are used at the moment.  They are numbered 0,1 and 2.  The sub-pool
number is the first argument to the <EM>emalloc</EM> and <EM>estrdup</EM>
functions.</P>
<DL>
<DT><STRONG>Pool 0 - Session lifespan</STRONG></DT>
<DD>Any memory allocated from this pool will span the entire session.
It is a good idea to keep the use of this pool as low as possible.
For example, if someone makes a while loop that iterates 1000 times and
within this while loop they call something which allocates memory from
pool 0, then this memory will be allocated 1000 times.  This is a quick
way to use up all alloted data space.</DD>
<DT><STRONG>Pool 1 - Temporary storage (shortest lifespan)</STRONG></DT>
<DD>If a temporary work buffer is needed for something within a function,
the memory for it must come from this pool.  This pool is cleared on every
call to yylex().  ie. the memory is lost just about as soon as you leave
a function.</DD>
<DT><STRONG>Pool 2 - Expression space (medium lifespan)</STRONG></DT>
<DD>This pool exists for the duration of an expression.  An expression in
this context being a full PHP/FI command line.  It will not get cleared
within functions since the higher level expression which called the
function has not been completed until the function returns.  The ClearIt
flag in the yylex() function indicates when it is safe to clear this
pool.</DD>
</DL>
<P>The use of sub-pools completely eliminates the need to explicitly free
memory anywhere in the code, with the one exception being memory allocated
using a regular malloc call by various libraries that could be linked into
PHP.  The gdbm library is one such example.</P>
</BODY>
</HTML>
